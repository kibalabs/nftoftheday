import os
import sys

sys.path.insert(0, os.path.dirname(os.path.dirname(__file__)))

import asyncio
import logging
from core.requester import Requester
from core.web3.eth_client import RestEthClient
import datetime


from notd.block_processor import BlockProcessor
from notd.model import  RetrievedTokenTransfer



async def main():
    requester = Requester()
    ethClient = RestEthClient(url=f'https://mainnet.infura.io/v3/{os.environ["INFURA_PROJECT_ID"]}', requester=requester)
    blockProcessor = BlockProcessor(ethClient=ethClient)

    result = await blockProcessor.get_transfers_in_block(13281280)
    expected = [
        RetrievedTokenTransfer(transactionHash='0x3a59e929b3dcdfd412ee35cb0d88a9b13693e38869d976bef92569e249b89dee', registryAddress='0x33825285eB66c11237Cc68CC182c1e9BF01bA00B', fromAddress='0x857784eA852149c21aD6025E94b715E753Cc2124', toAddress='0xF8ca0a9aAdfBD7470B77DB6D2498CDE243ba8420', operatorAddress='0xF8ca0a9aAdfBD7470B77DB6D2498CDE243ba8420', tokenId='4973', amount=1, value=164900000000000000, gasLimit=236924, gasPrice=58300000000, gasUsed=172508, blockNumber=13281280, blockHash='0x79da1d97baead833e2b4e597a24d08a0e5efddd2c7f0983f776836a8ffb03d4c', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 9), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0xf1f0758d54474efb810e470592349703adc758c5037e56ae1bd6a789e9a079ef', registryAddress='0x2216d47494E516d8206B70FCa8585820eD3C4946', fromAddress='0xffF8f66e26ac1A75F2b5Da49c247f3Ec0D0EA5ba', toAddress='0x0000000000000000000000000000000000080085', operatorAddress='0xffF8f66e26ac1A75F2b5Da49c247f3Ec0D0EA5ba', tokenId='14364', amount=1, value=0, gasLimit=449751, gasPrice=48786337690, gasUsed=271034, blockNumber=13281280, blockHash='0x79da1d97baead833e2b4e597a24d08a0e5efddd2c7f0983f776836a8ffb03d4c', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 9), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0xf1f0758d54474efb810e470592349703adc758c5037e56ae1bd6a789e9a079ef', registryAddress='0x2216d47494E516d8206B70FCa8585820eD3C4946', fromAddress='0xffF8f66e26ac1A75F2b5Da49c247f3Ec0D0EA5ba', toAddress='0x0000000000000000000000000000000000080085', operatorAddress='0xffF8f66e26ac1A75F2b5Da49c247f3Ec0D0EA5ba', tokenId='10626', amount=1, value=0, gasLimit=449751, gasPrice=48786337690, gasUsed=271034, blockNumber=13281280, blockHash='0x79da1d97baead833e2b4e597a24d08a0e5efddd2c7f0983f776836a8ffb03d4c', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 9), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0xf1f0758d54474efb810e470592349703adc758c5037e56ae1bd6a789e9a079ef', registryAddress='0x2216d47494E516d8206B70FCa8585820eD3C4946', fromAddress='0xffF8f66e26ac1A75F2b5Da49c247f3Ec0D0EA5ba', toAddress='0x0000000000000000000000000000000000080085', operatorAddress='0xffF8f66e26ac1A75F2b5Da49c247f3Ec0D0EA5ba', tokenId='10627', amount=1, value=0, gasLimit=449751, gasPrice=48786337690, gasUsed=271034, blockNumber=13281280, blockHash='0x79da1d97baead833e2b4e597a24d08a0e5efddd2c7f0983f776836a8ffb03d4c', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 9), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0xfb9e13d47dc451e8c080245488771a5589bc1e461a2911c8dcfd713267df5dbc', registryAddress='0xF8C08433DD41eAeE2e424C9E91467aB27772d9ec', fromAddress='0x44F360a7771888B5Ad92677D795aA10EA88203CA', toAddress='0x62F56981d431e68B5CAb37ae3A242a72824D3ac7', operatorAddress='0x44F360a7771888B5Ad92677D795aA10EA88203CA', tokenId='97', amount=1, value=0, gasLimit=60316, gasPrice=46000000000, gasUsed=41597, blockNumber=13281280, blockHash='0x79da1d97baead833e2b4e597a24d08a0e5efddd2c7f0983f776836a8ffb03d4c', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 9), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x786dedd3df009705c246629c864e839b78b897319d346540f10bb84dabbacbb4', registryAddress='0xC00d444eeD049ad0d858a4A8D6Cac5417054405D', fromAddress='0x089660619d26b6CA62EaCD74e2DdD6089024fcCc', toAddress='0xa1F39F1a900A44DDFC702f9071808a07B841f377', operatorAddress='0xa1F39F1a900A44DDFC702f9071808a07B841f377', tokenId='1681', amount=1, value=9000000000000000, gasLimit=331269, gasPrice=45871801906, gasUsed=235481, blockNumber=13281280, blockHash='0x79da1d97baead833e2b4e597a24d08a0e5efddd2c7f0983f776836a8ffb03d4c', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 9), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x35bf97445892e633811b0251cba7056f0f6d00d127b38e3414f9b219839a0d5a', registryAddress='0x06012c8cf97BEaD5deAe237070F9587f8E7A266d', fromAddress='0xb1690C08E213a35Ed9bAb7B318DE14420FB57d8C', toAddress='0x52b2A1cc5BF5701408A0aAB889fB5ab2Cf65275b', operatorAddress='0x52b2A1cc5BF5701408A0aAB889fB5ab2Cf65275b', tokenId='938228', amount=1, value=19857666997354498, gasLimit=168463, gasPrice=45721801906, gasUsed=96944, blockNumber=13281280, blockHash='0x79da1d97baead833e2b4e597a24d08a0e5efddd2c7f0983f776836a8ffb03d4c', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 9), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x5f240c53fafdf13e16ea02c3e94b8daec4c0d36272ea5cc639a211e344afd6c8', registryAddress='0xa64C5EC80784675bf289A4722a2eca180212f9dB', fromAddress='0x57B386815E928BBF43aB16cfD7f268E7f861c0AA', toAddress='0xf3E09Fa1754c77aECe0808197b2cAAE896b1C3eD', operatorAddress='0xf3E09Fa1754c77aECe0808197b2cAAE896b1C3eD', tokenId='1718', amount=1, value=50000000000000000, gasLimit=312990, gasPrice=45721801906, gasUsed=226220, blockNumber=13281280, blockHash='0x79da1d97baead833e2b4e597a24d08a0e5efddd2c7f0983f776836a8ffb03d4c', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 9), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0xd913164a0166140027e68fad832d1942cde756709c778697844f9ab10eb35e4c', registryAddress='0xC36442b4a4522E871399CD717aBDD847Ab11FE88', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x6B33a55786b2412c5283bfFc0383Ca35D702B388', operatorAddress='0x6B33a55786b2412c5283bfFc0383Ca35D702B388', tokenId='130999', amount=1, value=479676176628488569, gasLimit=626642, gasPrice=45681801906, gasUsed=493984, blockNumber=13281280, blockHash='0x79da1d97baead833e2b4e597a24d08a0e5efddd2c7f0983f776836a8ffb03d4c', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 9), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x355f53288cb9d9b91012470d681bd3453c5253d54f2becb17d20e4347432ce09', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', fromAddress='0x473fD7FB5826D0CB76903c8bFb5E8E0f1a717626', toAddress='0xCCa178a04D83Af193330C7927fb9a42212Fb1C25', operatorAddress='0x8945F51c47e1B2406f4D96c3E795010A59B954eb', tokenId='32227014266187574693694258784543567127334353629417101029986949134666818388768', amount=1, value=500000000000000000, gasLimit=271893, gasPrice=46221801906, gasUsed=201407, blockNumber=13281280, blockHash='0x79da1d97baead833e2b4e597a24d08a0e5efddd2c7f0983f776836a8ffb03d4c', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 9), tokenType='erc1155single'), 
        RetrievedTokenTransfer(transactionHash='0x3234d993232494cb0ac88ed94580e7c23b2291629c5321acb3793d51d732dc79', registryAddress='0xF1F3ca6268f330fDa08418db12171c3173eE39C9', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x5B1A00402c6aaBC799aa30d009Fb26ec7980BA0a', operatorAddress='0x5B1A00402c6aaBC799aa30d009Fb26ec7980BA0a', tokenId='8', amount=2, value=0, gasLimit=62020, gasPrice=46000000000, gasUsed=56382, blockNumber=13281280, blockHash='0x79da1d97baead833e2b4e597a24d08a0e5efddd2c7f0983f776836a8ffb03d4c', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 9), tokenType='erc1155single'), 
        RetrievedTokenTransfer(transactionHash='0xc23496871eaf21f0bcbb7a10fa449e1d0f307b1f4493c12d6a4009d21a73d4dd', registryAddress='0x9f75A77966ADE660782f73f822c836C32BE6784a', fromAddress='0xA09e8346B1F58F49622C81B7B1fe26441f0a8f28', toAddress='0x2953399124F0cBB46d2CbACD8A89cF0599974963', operatorAddress='0xA09e8346B1F58F49622C81B7B1fe26441f0a8f28', tokenId='41', amount=1, value=0, gasLimit=57213, gasPrice=45721801906, gasUsed=57213, blockNumber=13281280, blockHash='0x79da1d97baead833e2b4e597a24d08a0e5efddd2c7f0983f776836a8ffb03d4c', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 9), tokenType='erc1155single')
    ]
    assert (result == expected)

    result = await blockProcessor.get_transfers_in_block(12839305)
    expected = [
        RetrievedTokenTransfer(transactionHash='0xfc8ffb7652d77c1b880a80134bdce050c9bf712610fa9dc0d3d3fa83c10d3a1b', registryAddress='0xFBB6684EbD6093989740e8ef3e7D57cf3813E5a4', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x18090cDA49B21dEAffC21b4F886aed3eB787d032', operatorAddress='0x18090cDA49B21dEAffC21b4F886aed3eB787d032', tokenId='9991', amount=1, value=0, gasLimit=184165, gasPrice=40000000000, gasUsed=184165, blockNumber=12839305, blockHash='0x7e36a9f127f3413595ef0f1c4165e4547d20ab566b66fc51a3cbe9eb048f3154', blockDate=datetime.datetime(2021, 7, 16, 18, 41, 41), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x3093bb2c8cbf1d229594d2cb8b172558fb6730721d9ef561b6400543a59f3734', registryAddress='0x049aba7510f45BA5b64ea9E658E342F904DB358D', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x54A5A62D34d3C55Cb35Bb8B4d4C958c820c5f322', operatorAddress='0x54A5A62D34d3C55Cb35Bb8B4d4C958c820c5f322', tokenId='111875105896522767201998009571114989808106447240989160672650322275489228602620', amount=1, value=0, gasLimit=147908, gasPrice=40000000000, gasUsed=115697, blockNumber=12839305, blockHash='0x7e36a9f127f3413595ef0f1c4165e4547d20ab566b66fc51a3cbe9eb048f3154', blockDate=datetime.datetime(2021, 7, 16, 18, 41, 41), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x7d15427902a0ae5cb45b20cb38ab4ef0aab204ba1e4ae120f2b3b4d1c40cb688', registryAddress='0x395E5461693e0bB5EC78302605030050f69e628d', fromAddress='0x913C7fa57e6690f96B4AEB65553f0ED3664CAF8b', toAddress='0xA8E3582964ffA96621a767468b1D66207211df00', operatorAddress='0x913C7fa57e6690f96B4AEB65553f0ED3664CAF8b', tokenId='1861', amount=1, value=0, gasLimit=97681, gasPrice=40000000000, gasUsed=82681, blockNumber=12839305, blockHash='0x7e36a9f127f3413595ef0f1c4165e4547d20ab566b66fc51a3cbe9eb048f3154', blockDate=datetime.datetime(2021, 7, 16, 18, 41, 41), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x610b0e54f476ecada3fcc5afe330e967b0f8cc22dafa4cd1983f0f2a204bead3', registryAddress='0xd07dc4262BCDbf85190C01c996b4C06a461d2430', fromAddress='0xe46ec6498B186AaA8C2222c703c463982734D01A', toAddress='0x7AFB8fAC50362DDf276df66a8010ff032BBE1345', operatorAddress='0x4feE7B061C97C9c496b01DbcE9CDb10c02f0a0Be', tokenId='640491', amount=18, value=1826550000000000000, gasLimit=329641, gasPrice=40000000000, gasUsed=325169, blockNumber=12839305, blockHash='0x7e36a9f127f3413595ef0f1c4165e4547d20ab566b66fc51a3cbe9eb048f3154', blockDate=datetime.datetime(2021, 7, 16, 18, 41, 41), tokenType='erc1155single'), 
        RetrievedTokenTransfer(transactionHash='0x9e52523fc2de27af5e927d20a5b895024c46d7e9cebe758303c9768c3f756c19', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', fromAddress='0xDc62e941fDDBDdDFc666B133E24E0C1aFae11847', toAddress='0xC4e245226537A0B1c5AF30079Eb0251504b42793', operatorAddress='0x750a32FAB9AE3B4ba3c15fF3d140b19aC92f25D8', tokenId='99683587586696680377209091673774721318238762396163454333212325529815842029569', amount=1, value=50000000000000000, gasLimit=228450, gasPrice=40000000000, gasUsed=218447, blockNumber=12839305, blockHash='0x7e36a9f127f3413595ef0f1c4165e4547d20ab566b66fc51a3cbe9eb048f3154', blockDate=datetime.datetime(2021, 7, 16, 18, 41, 41), tokenType='erc1155single')
    ]
    assert (result == expected)

    result = await blockProcessor.get_transfers_in_block(13281282)
    expected = [
        RetrievedTokenTransfer(transactionHash='0x36c5004fc6279dd2c213626d841cafea4e2f69d1c03267211f01fde295ec23a1', registryAddress='0xbe6e3669464E7dB1e1528212F0BfF5039461CB82', fromAddress='0xa0EfBA909AFb7D8B284cA95Df6BEce062575df03', toAddress='0xE24b69F465eAD3c5De169E73b524f0e95BBC2233', operatorAddress='0xa0EfBA909AFb7D8B284cA95Df6BEce062575df03', tokenId='640', amount=1, value=0, gasLimit=387696, gasPrice=60500000000, gasUsed=283686, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x232ff4966ecb9b17f48fb04ad89a9dbc6b98403b2a4a63df95bbc693343405c9', registryAddress='0xdf9Aa1012Fa49DC1d2a306e3e65EF1797d2b5fBb', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x9317d29f94f9f399ED27048a14bBaE81D7fd73fB', operatorAddress='0xF6A978aB977615eDd6E2299758aE9aedB9c25a7f', tokenId='95587', amount=1, value=0, gasLimit=300000, gasPrice=60342876911, gasUsed=84459, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x6ff77bdef9dcb019179f07e1d53fd437faade539c2cde62582d9181606a2f2ae', registryAddress='0xdf9Aa1012Fa49DC1d2a306e3e65EF1797d2b5fBb', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x9317d29f94f9f399ED27048a14bBaE81D7fd73fB', operatorAddress='0x917BfDd1572AccCA46237f4388460393d7b4AAe8', tokenId='95584', amount=1, value=0, gasLimit=300000, gasPrice=60342876911, gasUsed=84459, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0xb7a942ac2f946930195af1aac801ef426d04fddb371b286765d338749cbabd3d', registryAddress='0xdf9Aa1012Fa49DC1d2a306e3e65EF1797d2b5fBb', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x9317d29f94f9f399ED27048a14bBaE81D7fd73fB', operatorAddress='0x0a75FeC70876E12FD6417E1091d6b4d5d83a6Af4', tokenId='95578', amount=1, value=0, gasLimit=300000, gasPrice=55987064157, gasUsed=84459, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x6473d8350cd1f3cc403103ae40ea6e4dcafb2533667cd5cabcdc84184ed4830a', registryAddress='0xdf9Aa1012Fa49DC1d2a306e3e65EF1797d2b5fBb', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x9317d29f94f9f399ED27048a14bBaE81D7fd73fB', operatorAddress='0xfca7E99a3cA579a0111b908BfdfE498BbF52A2FB', tokenId='95583', amount=1, value=0, gasLimit=300000, gasPrice=55000000000, gasUsed=84459, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x41101638e36f6b95de958db91ea584064be8dc2cdf8f302f16b71b3ce7536d00', registryAddress='0xC0cf5B82Ae2352303b2EA02c3bE88e23f2594171', fromAddress='0xE052113bd7D7700d623414a0a4585BCaE754E9d5', toAddress='0x88D5F4AC2d78d74076A80402B63d8bBf3412aDaA', operatorAddress='0xE052113bd7D7700d623414a0a4585BCaE754E9d5', tokenId='22700083048', amount=1, value=0, gasLimit=161103, gasPrice=53900000000, gasUsed=124653, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0xc34b3cf19e00814f37ed2d93a0fa0a21a3d061f955d61b21f89df64b3e6cd209', registryAddress='0x335eEEF8e93A7A757D9e7912044d9cd264e2b2D8', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x4d99D5C7698D69F02f2CAC5532258cd80485B29f', operatorAddress='0x4d99D5C7698D69F02f2CAC5532258cd80485B29f', tokenId='3857', amount=1, value=70000000000000000, gasLimit=240993, gasPrice=52862462303, gasUsed=155670, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0xb6adbd489a825f0da1b58be6122b0157a7c85d5b8bfa08f6683b7ebbdadb1421', registryAddress='0x6dFCB04b7d2aB2069d9ba81aC643556429EB2d55', fromAddress='0x09A3Ed4C3B477E53850edE0AAC96681BA314193B', toAddress='0x364F53FDc05AFBccd4db2053cE912840E8f08D9D', operatorAddress='0x364F53FDc05AFBccd4db2053cE912840E8f08D9D', tokenId='5983', amount=1, value=30000000000000000, gasLimit=303158, gasPrice=50291118272, gasUsed=218657, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x483b2c81d0359c4dc12b60a249e98b0ad82da2ad50348b6eeb2ba851918caec1', registryAddress='0x225301b500678E15A64B59609D8e00C2413AB426', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', operatorAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', tokenId='1', amount=1, value=0, gasLimit=1000000, gasPrice=50000000000, gasUsed=762473, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x483b2c81d0359c4dc12b60a249e98b0ad82da2ad50348b6eeb2ba851918caec1', registryAddress='0x225301b500678E15A64B59609D8e00C2413AB426', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', operatorAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', tokenId='2', amount=1, value=0, gasLimit=1000000, gasPrice=50000000000, gasUsed=762473, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x483b2c81d0359c4dc12b60a249e98b0ad82da2ad50348b6eeb2ba851918caec1', registryAddress='0x225301b500678E15A64B59609D8e00C2413AB426', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', operatorAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', tokenId='3', amount=1, value=0, gasLimit=1000000, gasPrice=50000000000, gasUsed=762473, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x483b2c81d0359c4dc12b60a249e98b0ad82da2ad50348b6eeb2ba851918caec1', registryAddress='0x225301b500678E15A64B59609D8e00C2413AB426', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', operatorAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', tokenId='4', amount=1, value=0, gasLimit=1000000, gasPrice=50000000000, gasUsed=762473, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x483b2c81d0359c4dc12b60a249e98b0ad82da2ad50348b6eeb2ba851918caec1', registryAddress='0x225301b500678E15A64B59609D8e00C2413AB426', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', operatorAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', tokenId='5', amount=1, value=0, gasLimit=1000000, gasPrice=50000000000, gasUsed=762473, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x483b2c81d0359c4dc12b60a249e98b0ad82da2ad50348b6eeb2ba851918caec1', registryAddress='0x225301b500678E15A64B59609D8e00C2413AB426', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', operatorAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', tokenId='6', amount=1, value=0, gasLimit=1000000, gasPrice=50000000000, gasUsed=762473, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x418a1da25db4e610b1acfba1fdd52556d6f3c3c53cea639b6de1b68a1ead9fcf', registryAddress='0x05a46f1E545526FB803FF974C790aCeA34D1f2D6', fromAddress='0xB0ebEeAc1a25CC7Ba8e429D5f8fA911de3f2672B', toAddress='0x08543f4c79f7e5d585A2622cA485e8201eFd9aDA', operatorAddress='0xB0ebEeAc1a25CC7Ba8e429D5f8fA911de3f2672B', tokenId='6403', amount=1, value=0, gasLimit=161350, gasPrice=49791118272, gasUsed=156550, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0xc1d0b54d0d61ced4a2ad2fe53acd4537f00c528e3984c21ec365564b41fd7218', registryAddress='0x6dFCB04b7d2aB2069d9ba81aC643556429EB2d55', fromAddress='0xc5a1a4863eB957021aa4F1Ba4aB02549059aEa5B', toAddress='0xB3c526d61aDd017084ECE11f6CB72893387520D8', operatorAddress='0xB3c526d61aDd017084ECE11f6CB72893387520D8', tokenId='5863', amount=1, value=50000000000000000, gasLimit=303158, gasPrice=49791118272, gasUsed=218657, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x50505ac66dfc62345a0da374ccc0d298427338bb5320d2b9ba3c762f86f71af7', registryAddress='0x25C65721E26fa5F3c97f129F4e24972482327BC9', fromAddress='0xeb6f1a21B99FaDb73C4bA4331D71360918723eb7', toAddress='0xF20A3c4781c5726ea011Fa869e3C5aA4dddb9882', operatorAddress='0xF20A3c4781c5726ea011Fa869e3C5aA4dddb9882', tokenId='4461', amount=1, value=59000000000000000, gasLimit=294506, gasPrice=49791118272, gasUsed=216802, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x8ed68004e9df484dae1ecbd6211b99b88d551a05cfefcafdd29b63fc43863d89', registryAddress='0x6dFCB04b7d2aB2069d9ba81aC643556429EB2d55', fromAddress='0x335f82268d54807104561ceA27900A0CC913a8A2', toAddress='0xAa6B43b77b4Df6ccCd971699a54b4e2866389a43', operatorAddress='0xAa6B43b77b4Df6ccCd971699a54b4e2866389a43', tokenId='3162', amount=1, value=39000000000000000, gasLimit=316781, gasPrice=49791118272, gasUsed=216836, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0xb13c78498968568e626ac492847a29badae7e5805efd8b0d0169ba6e8c58b524', registryAddress='0xa7eE407497b2Aeb43580cabe2B04026b5419D1dc', fromAddress='0xBdD95ABE8a7694CCD77143376b0fBea183E6a740', toAddress='0x571ad36DeD93eC62df5deBa152352DE69C720056', operatorAddress='0x571ad36DeD93eC62df5deBa152352DE69C720056', tokenId='9691', amount=1, value=84900000000000000, gasLimit=262066, gasPrice=49791118272, gasUsed=196648, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x64ef1bc3f512db177bce74600c94f5e3dad853c41c4121b28777f5b0296848f6', registryAddress='0x3AF65d01F6CDe41965a2D591BB399C8f0Db76AFd', fromAddress='0xaa114724F2bCBD859d01585435E3076671314D2E', toAddress='0x4E9fD21519Cf3D1FeA8c0deBbB9F91814A3D0d62', operatorAddress='0x4E9fD21519Cf3D1FeA8c0deBbB9F91814A3D0d62', tokenId='227', amount=1, value=36900000000000000, gasLimit=301243, gasPrice=49791118272, gasUsed=217184, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0xbeee7c21a2fed8f99adc89b890d3bd1a3cb0591e54d161fb63ce51a2096152e1', registryAddress='0xd153f0014db6d1F339c6340d2C9F59214355D9d7', fromAddress='0x6d311DC526D59edEc79e03fcab01B8e0a5d60dAC', toAddress='0x2C507ED5B4857B54d7235393ac8B36ec7E84b6E6', operatorAddress='0x2C507ED5B4857B54d7235393ac8B36ec7E84b6E6', tokenId='6326', amount=1, value=249000000000000000, gasLimit=301385, gasPrice=49791118272, gasUsed=217293, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0xda0fbfacc71f881b57cf5a47c774ec6ca7aaa685352b3c89bbaff9fd88f71487', registryAddress='0xF8C08433DD41eAeE2e424C9E91467aB27772d9ec', fromAddress='0x351AFD0681282aD0f9eF609aCFA1Ec2418082036', toAddress='0xDE60BCc0F87564F4f4309a241Ad9c9d762c43b12', operatorAddress='0x351AFD0681282aD0f9eF609aCFA1Ec2418082036', tokenId='1961', amount=1, value=0, gasLimit=46409, gasPrice=49791118272, gasUsed=41609, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x3b5a997a6f9c0dca5b038e4a5edb67dbace029760fbcf3561e6dc66c31a7ea81', registryAddress='0xC2C747E0F7004F9E8817Db2ca4997657a7746928', fromAddress='0xB776624bb2302Ef3499B5F8E2e75B55165cc7a6D', toAddress='0xc8581bFFFa683B205A6799A9D26fF197Ccb33117', operatorAddress='0xB776624bb2302Ef3499B5F8E2e75B55165cc7a6D', tokenId='7759', amount=1, value=0, gasLimit=117277, gasPrice=49791118272, gasUsed=107677, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x40ca42957f1f532064f0c479c3dd229d33b7d5d58d674794f4ef6a89353d9d07', registryAddress='0xf3DFbE887D81C442557f7a59e3a0aEcf5e39F6aa', fromAddress='0xBC244D31a3686F8f60224A86067D979BFA926BA0', toAddress='0x1bC836F5844C4e257D19f11DA540b051aA550AA4', operatorAddress='0x1bC836F5844C4e257D19f11DA540b051aA550AA4', tokenId='7948', amount=1, value=80000000000000000, gasLimit=301170, gasPrice=49791118272, gasUsed=217128, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x2d8423aac26c4b856f216294d35f4a6eb94f09d0baa3880828af3cdfe97b46de', registryAddress='0x71355f4a94f46eE32EB443aD2BDE2DeC0470f949', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', operatorAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', tokenId='134', amount=1, value=0, gasLimit=416281, gasPrice=49791118272, gasUsed=414385, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x4550fdb52840250fa9fc914ea03a6659257b34ef5674b4b0d88f5e8ae17d82d3', registryAddress='0x1D20A51F088492A0f1C57f047A9e30c9aB5C07Ea', fromAddress='0xE2008Ef79a7d0D75EdAE70263384D4aC5D1A9f9A', toAddress='0xDAAe53f14dc00b383068156dB3464E76a2fdb7C1', operatorAddress='0xDAAe53f14dc00b383068156dB3464E76a2fdb7C1', tokenId='2852', amount=1, value=1400000000000000000, gasLimit=297281, gasPrice=49791118272, gasUsed=218936, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0xa1da8fe2261591da0fefe5bca78a4c2dc7f6efb76b4c3fdca9adc85d4b1f8cbb', registryAddress='0x9f4292bd05a5c89F007bDeF3a95fC32bc1021b99', fromAddress='0x36B049dAC44B130879C10f36C9031cd36b8cA08C', toAddress='0xEB3f24f3cD709Fa3A1eDE5f1C11aA93b8741d32C', operatorAddress='0x36B049dAC44B130879C10f36C9031cd36b8cA08C', tokenId='9651', amount=1, value=0, gasLimit=104703, gasPrice=49791118272, gasUsed=93963, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x95c775d6e2ad6cd338df87f60ef2826b218c82bb7b3d182b5e427e3907fce234', registryAddress='0x3a8778A58993bA4B941f85684D74750043A4bB5f', fromAddress='0x0fA36ea577AD67C61e0b7631C55BD305533B8C94', toAddress='0x6E81aF1BcD504a51Da5BD6A0d7DF70D7674CE90E', operatorAddress='0x0fA36ea577AD67C61e0b7631C55BD305533B8C94', tokenId='2014', amount=1, value=0, gasLimit=94599, gasPrice=49791118272, gasUsed=84999, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x95addcc09c4236fee5280bbdd2e74d830566430acd5c3438b308bcac49c7349c', registryAddress='0x3B3ee1931Dc30C1957379FAc9aba94D1C48a5405', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xfaB40a7F7de738469Dbe19C9763AC47a458314F2', operatorAddress='0xfaB40a7F7de738469Dbe19C9763AC47a458314F2', tokenId='89793', amount=1, value=0, gasLimit=336828, gasPrice=49791118272, gasUsed=301665, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x2363ae2de6b0718175b27e44431273bb5e5e876ace028535e36d3251c18f1742', registryAddress='0x52607cb9c342821ea41ad265B9Bb6a23BEa49468', fromAddress='0x9516d0145eD67839646AcDdBDd344E6708130C15', toAddress='0xc134eb26CAC544A24a97B0D108DC36E7E41172Ad', operatorAddress='0xc134eb26CAC544A24a97B0D108DC36E7E41172Ad', tokenId='3581', amount=1, value=39000000000000000, gasLimit=307601, gasPrice=49791118272, gasUsed=222075, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0xdb417a316d587977fe02147c58964a0c23cb642f0b67fca7f334797d7d9e13d7', registryAddress='0xa7d8d9ef8D8Ce8992Df33D8b8CF4Aebabd5bD270', fromAddress='0x6e54630b1C6961A75Bc6337e4E732Cb2c74d7a7A', toAddress='0x73857350FF2e6882253CccC1a1d2d2ae6EA4ea84', operatorAddress='0x6e54630b1C6961A75Bc6337e4E732Cb2c74d7a7A', tokenId='130000412', amount=1, value=0, gasLimit=266544, gasPrice=49791118272, gasUsed=205794, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0xdb417a316d587977fe02147c58964a0c23cb642f0b67fca7f334797d7d9e13d7', registryAddress='0xa7d8d9ef8D8Ce8992Df33D8b8CF4Aebabd5bD270', fromAddress='0x6e54630b1C6961A75Bc6337e4E732Cb2c74d7a7A', toAddress='0x73857350FF2e6882253CccC1a1d2d2ae6EA4ea84', operatorAddress='0x6e54630b1C6961A75Bc6337e4E732Cb2c74d7a7A', tokenId='134000057', amount=1, value=0, gasLimit=266544, gasPrice=49791118272, gasUsed=205794, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x6aeddc15c90548604194c9b7bca7cdbedb7e5624045bbdf47410b20448658c16', registryAddress='0xF407B994F05d2b2cA66534517a9C85a117Db54A5', fromAddress='0xf11DCB438Ef856C536979B00d971F1A3AFE289cC', toAddress='0xc4C2E9FFB56efdD80cF1f40b304C9e8ff25D61cD', operatorAddress='0xf11DCB438Ef856C536979B00d971F1A3AFE289cC', tokenId='1732', amount=1, value=0, gasLimit=134892, gasPrice=49791118272, gasUsed=125292, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0x8fce9936306e7de7e61cd95e2c59e8467b5c5d104df71ea84a9997e095435f24', registryAddress='0x6dFCB04b7d2aB2069d9ba81aC643556429EB2d55', fromAddress='0x787551ae0AB07dE8EB91d1535DBD37f379B0111D', toAddress='0xc797308Ab2d7e643Ceb92465B38cc6C001e5A3DA', operatorAddress='0xc797308Ab2d7e643Ceb92465B38cc6C001e5A3DA', tokenId='6301', amount=1, value=45000000000000000, gasLimit=316734, gasPrice=49791118272, gasUsed=229100, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0xa3d4eaea7c29aa040f54426b8d88d85dfaa104f0cd09fde594c75cc5476caafd', registryAddress='0x6dFCB04b7d2aB2069d9ba81aC643556429EB2d55', fromAddress='0xD49322ADD203C8e04ACDD53B7fF14B5E0AC861D7', toAddress='0xF7ccC7126addDEE2d76EFF0f9f2635857f6E1680', operatorAddress='0xF7ccC7126addDEE2d76EFF0f9f2635857f6E1680', tokenId='4898', amount=1, value=38000000000000000, gasLimit=294488, gasPrice=49791118272, gasUsed=216788, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc721'), 
        RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', tokenId='92239469154549493527197540724254834850645073994564312704917306496371006636033', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, gasUsed=1040421, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155single'), 
        RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', tokenId='92239469154549493527197540724254834850645073994564312704917306499669541519361', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, gasUsed=1040421, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155single'), 
        RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', tokenId='92239469154549493527197540724254834850645073994564312704917306510664657797121', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, gasUsed=1040421, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155single'), 
        RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', tokenId='92239469154549493527197540724254834850645073994564312704917306588729983369217', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, gasUsed=1040421, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155single'), 
        RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0xd07dc4262BCDbf85190C01c996b4C06a461d2430', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', tokenId='514337', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, gasUsed=1040421, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155single'), 
        RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', tokenId='92239469154549493527197540724254834850645073994564312704917306630511425224705', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, gasUsed=1040421, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155single'), 
        RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', tokenId='92239469154549493527197540724254834850645073994564312704917306633809960108047', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, gasUsed=1040421, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155single'), 
        RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', tokenId='92239469154549493527197540724254834850645073994564312704917306678889936846863', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, gasUsed=1040421, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155single'), 
        RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', tokenId='80494307024529346018053650490912529916739680814770830097664395766818859384898', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, gasUsed=1040421, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155single'), 
        RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', tokenId='80494307024529346018053650490912529916739680814770830097664395774515440779395', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, gasUsed=1040421, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155single'), 
        RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', tokenId='80494307024529346018053650490912529916739680814770830097664395786610068684830', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, gasUsed=1040421, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155single'), 
        RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', tokenId='80494307024529346018053650490912529916739680814770830097664395791008115195927', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, gasUsed=1040421, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155single'), 
        RetrievedTokenTransfer(transactionHash='0x0ee725c58965572507270564cec4c2037c96d07dc47ad3aa1e632c6601c39952', registryAddress='0x73DA73EF3a6982109c4d5BDb0dB9dd3E3783f313', fromAddress='0x015F08Af4Fe34e94BF363034b62033FE5167eC32', toAddress='0x6eADc94432fBfF59836959bb38F0cD34Bf50781B', operatorAddress='0x015F08Af4Fe34e94BF363034b62033FE5167eC32', tokenId='7', amount=1, value=0, gasLimit=56514, gasPrice=49791118272, gasUsed=51714, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155single'), 
        RetrievedTokenTransfer(transactionHash='0xd472f726343a30e1fa6b57d89a8463849ef5e7fb87b38a65dc1acf456270947e', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', fromAddress='0x473fD7FB5826D0CB76903c8bFb5E8E0f1a717626', toAddress='0xeBD9BB8bb470051339a7F13AB6842397B9cD6254', operatorAddress='0x8945F51c47e1B2406f4D96c3E795010A59B954eb', tokenId='32227014266187574693694258784543567127334353629417101029986949134666818388768', amount=1, value=500000000000000000, gasLimit=249647, gasPrice=49791118272, gasUsed=184295, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155single'), 
        RetrievedTokenTransfer(transactionHash='0x006d45c631a8be9b77cb40f161963af4e004f4b319f545d8d1bf23469c9c5e8f', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', fromAddress='0x114DE67e89Ca25767a6aec9430129FeE58eFF8Ad', toAddress='0x2d6bC5b701812107D4bFe5C24024bE7A173AB143', operatorAddress='0x0a1819D0858A1C2eCEfe424342B9fA0b812B7507', tokenId='7826956463027448225520519187082793484908476728102208308696043473228661784577', amount=1, value=100000000000000000, gasLimit=294652, gasPrice=49791118272, gasUsed=218914, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155single'), 
        RetrievedTokenTransfer(transactionHash='0xf4279c8e88f0fdb215d829462b76e4c2d2e1f2af8947de818cd8e8640a9c287c', registryAddress='0xE885d519025348e30174A218BE3e3E4754222860', fromAddress='0xd815FEaeb858838690440F7298Eb0465b27a7Ff4', toAddress='0xF4d197E35ee93B3C72bAf817172C4F48F4727240', operatorAddress='0x19932899084A9C608d3C633E1A23a27f4734074D', tokenId='2', amount=1, value=310000000000000000, gasLimit=233417, gasPrice=49791118272, gasUsed=174610, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155single'), 
        RetrievedTokenTransfer(transactionHash='0x3a90f87bf49ee4ae243589732abfc6f15968c53a396ee868c7d17f0efc94218d', registryAddress='0xFAFf15C6cDAca61a4F87D329689293E07c98f578', fromAddress='0x9ef4ACc2Fd5cde01ECe05BD4e44732a023ed7845', toAddress='0x9ef4ACc2Fd5cde01ECe05BD4e44732a023ed7845', operatorAddress='0x9ef4ACc2Fd5cde01ECe05BD4e44732a023ed7845', tokenId='5', amount=1, value=0, gasLimit=32364, gasPrice=49791118272, gasUsed=29564, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155single'), 
        RetrievedTokenTransfer(transactionHash='0x32138904d651a006dbbed36f1c7239c8a0feb7d6941d6ce74a36e0c10ea95ff0', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', fromAddress='0xEf8ACC51b6411af79FFdaD8182394F0d7792445b', toAddress='0xEbA16886d5fAF77A608B569C5a2520A0875b55aF', operatorAddress='0x1afA7E683fA180630329A982b3fe5457404Fa78B', tokenId='108348005865544129040411552508209223114542272553772717755275978878399503400961', amount=1, value=133700000000000000, gasLimit=294466, gasPrice=49791118272, gasUsed=218771, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155single'), 
        RetrievedTokenTransfer(transactionHash='0x2d8423aac26c4b856f216294d35f4a6eb94f09d0baa3880828af3cdfe97b46de', registryAddress='0x9b51A88Cffe9B50E043661ddD7F492cc3888fcbF', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', operatorAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', tokenId='51539804160', amount=1, value=0, gasLimit=416281, gasPrice=49791118272, gasUsed=414385, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155batch'), 
        RetrievedTokenTransfer(transactionHash='0x2d8423aac26c4b856f216294d35f4a6eb94f09d0baa3880828af3cdfe97b46de', registryAddress='0x9b51A88Cffe9B50E043661ddD7F492cc3888fcbF', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', operatorAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', tokenId='196609', amount=1, value=0, gasLimit=416281, gasPrice=49791118272, gasUsed=414385, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155batch'), 
        RetrievedTokenTransfer(transactionHash='0x2d8423aac26c4b856f216294d35f4a6eb94f09d0baa3880828af3cdfe97b46de', registryAddress='0x9b51A88Cffe9B50E043661ddD7F492cc3888fcbF', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', operatorAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', tokenId='458754', amount=1, value=0, gasLimit=416281, gasPrice=49791118272, gasUsed=414385, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155batch'), 
        RetrievedTokenTransfer(transactionHash='0x2d8423aac26c4b856f216294d35f4a6eb94f09d0baa3880828af3cdfe97b46de', registryAddress='0x9b51A88Cffe9B50E043661ddD7F492cc3888fcbF', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', operatorAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', tokenId='589827', amount=1, value=0, gasLimit=416281, gasPrice=49791118272, gasUsed=414385, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155batch'), 
        RetrievedTokenTransfer(transactionHash='0x2d8423aac26c4b856f216294d35f4a6eb94f09d0baa3880828af3cdfe97b46de', registryAddress='0x9b51A88Cffe9B50E043661ddD7F492cc3888fcbF', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', operatorAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', tokenId='786436', amount=1, value=0, gasLimit=416281, gasPrice=49791118272, gasUsed=414385, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155batch'), 
        RetrievedTokenTransfer(transactionHash='0x2d8423aac26c4b856f216294d35f4a6eb94f09d0baa3880828af3cdfe97b46de', registryAddress='0x9b51A88Cffe9B50E043661ddD7F492cc3888fcbF', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', operatorAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', tokenId='720901', amount=1, value=0, gasLimit=416281, gasPrice=49791118272, gasUsed=414385, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155batch'), 
        RetrievedTokenTransfer(transactionHash='0x2d8423aac26c4b856f216294d35f4a6eb94f09d0baa3880828af3cdfe97b46de', registryAddress='0x9b51A88Cffe9B50E043661ddD7F492cc3888fcbF', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', operatorAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', tokenId='8590065670', amount=1, value=0, gasLimit=416281, gasPrice=49791118272, gasUsed=414385, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155batch'), 
        RetrievedTokenTransfer(transactionHash='0x2d8423aac26c4b856f216294d35f4a6eb94f09d0baa3880828af3cdfe97b46de', registryAddress='0x9b51A88Cffe9B50E043661ddD7F492cc3888fcbF', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', operatorAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', tokenId='55834640391', amount=1, value=0, gasLimit=416281, gasPrice=49791118272, gasUsed=414385, blockNumber=13281282, blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9', blockDate=datetime.datetime(2021, 9, 23, 10, 50, 40), tokenType='erc1155batch')
    ]
    assert (result == expected)

    result = await blockProcessor.get_transfers_in_block(13898509)
    expected = [
        RetrievedTokenTransfer(transactionHash='0x24de708a8a36d16a68c69d973b3d2126c0d9fd01669335839697f71f7d50d397', registryAddress='0x60E4d786628Fea6478F785A6d7e704777c86a7c6', fromAddress='0xC310e760778ECBca4C65B6C559874757A4c4Ece0', toAddress='0x67D5fa7b939899d088A9d548EB9490a379deB912', tokenId='27160', value=16005000000000000000, gasLimit=314274, gasPrice=82944034756, gasUsed=204716, blockNumber=13898509, blockHash='0x0ad4d72b353a6232b69e72bb270457fd4f3c640e40483744d0f0b9997dc2e4e8', blockDate=datetime.datetime(2021, 12, 29, 7, 5, 3)), 
        RetrievedTokenTransfer(transactionHash='0x4276409534cc165ef7872a336ed8db65c40428de163406f2b3cf9c4ecdfa9d7b', registryAddress='0x828B78e11BC6A061b8b1AB9CF29C68ED6Abb247B', fromAddress='0x59CacaD5f405C369E092be30c7B571384fcB0A9d', toAddress='0xa511Bf40cF8A5090a3cc19C6DF38dbCC1DC755A3', tokenId='354', value=90000000000000000, gasLimit=313653, gasPrice=79444034756, gasUsed=240144, blockNumber=13898509, blockHash='0x0ad4d72b353a6232b69e72bb270457fd4f3c640e40483744d0f0b9997dc2e4e8', blockDate=datetime.datetime(2021, 12, 29, 7, 5, 3)), 
        RetrievedTokenTransfer(transactionHash='0x6bb37dcb9a60ed49da56ccfb21dfcae886e81debd3ab94d73497d62744e758d2', registryAddress='0x57f1887a8BF19b14fC0dF6Fd9B2acc9Af147eA85', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x283Af0B28c62C092C9727F1Ee09c02CA627EB7F5', tokenId='53091478429947851570161017064535674537231673781900674689421707367586767084753', value=1446765707746493, gasLimit=295604, gasPrice=79444034756, gasUsed=264772, blockNumber=13898509, blockHash='0x0ad4d72b353a6232b69e72bb270457fd4f3c640e40483744d0f0b9997dc2e4e8', blockDate=datetime.datetime(2021, 12, 29, 7, 5, 3)), 
        RetrievedTokenTransfer(transactionHash='0x6bb37dcb9a60ed49da56ccfb21dfcae886e81debd3ab94d73497d62744e758d2', registryAddress='0x57f1887a8BF19b14fC0dF6Fd9B2acc9Af147eA85', fromAddress='0x283Af0B28c62C092C9727F1Ee09c02CA627EB7F5', toAddress='0x04c1f61baF8DE8DA75DB52f09D9d92a1592f46eA', tokenId='53091478429947851570161017064535674537231673781900674689421707367586767084753', value=1446765707746493, gasLimit=295604, gasPrice=79444034756, gasUsed=264772, blockNumber=13898509, blockHash='0x0ad4d72b353a6232b69e72bb270457fd4f3c640e40483744d0f0b9997dc2e4e8', blockDate=datetime.datetime(2021, 12, 29, 7, 5, 3)), 
        RetrievedTokenTransfer(transactionHash='0x6f1e7cd317033576834b26edac15a8554de2e680e3ca2bf089905460e8e5eb12', registryAddress='0x176e0Fe17314DEf59F0F06e976E1b74203be4a55', fromAddress='0xD4506C84436a40621DBC1d2DFa8046d80fe9a09b', toAddress='0x294b6439E6c49799F13C6b90E804828fE8384d4F', tokenId='3232', value=10000000000000000, gasLimit=259232, gasPrice=79444034756, gasUsed=194468, blockNumber=13898509, blockHash='0x0ad4d72b353a6232b69e72bb270457fd4f3c640e40483744d0f0b9997dc2e4e8', blockDate=datetime.datetime(2021, 12, 29, 7, 5, 3)), 
        RetrievedTokenTransfer(transactionHash='0xd7bad8ba0aa35a838b7abe49fe4bda5e57185977346140d4bd13b1bc95568c4b', registryAddress='0xbD275ce24f32d6cE4e9d9519C55ABe9Bc0ed7fCf', fromAddress='0xBffe952968A7526fce2b03544Af5E8D5df9c071e', toAddress='0xc69004e5384391D86C002643D84da620B26e89D8', tokenId='2717', value=690000000000000000, gasLimit=303168, gasPrice=79444034756, gasUsed=218665, blockNumber=13898509, blockHash='0x0ad4d72b353a6232b69e72bb270457fd4f3c640e40483744d0f0b9997dc2e4e8', blockDate=datetime.datetime(2021, 12, 29, 7, 5, 3)), 
        RetrievedTokenTransfer(transactionHash='0xfd6de8afeede32ae5cf28a79b6f68cba295e4a9c1291b6f6302a70b03922c0e5', registryAddress='0x524cAB2ec69124574082676e6F654a18df49A048', fromAddress='0x5D33503BF891cdD3410AE975D5e929caF72BfeCb', toAddress='0x017146F8ebD8659672063E0d88dC1085f73fE79B', tokenId='22196', value=23000000000000000, gasLimit=235328, gasPrice=79444034756, gasUsed=171280, blockNumber=13898509, blockHash='0x0ad4d72b353a6232b69e72bb270457fd4f3c640e40483744d0f0b9997dc2e4e8', blockDate=datetime.datetime(2021, 12, 29, 7, 5, 3)), 
        RetrievedTokenTransfer(transactionHash='0x6d3d879469e8ae00f9b48b980d0cf22ff4c5422ee58d3b11ca9d2f38218f125e', registryAddress='0x5BDf397bB2912859Dbd8011F320a222f79A28d2E', fromAddress='0x65c4236EaEB83a96c3B16A6eA71785951FA8709b', toAddress='0x28Fe130724e02956E3253377eC7a127BB32EC481', tokenId='1406', value=295000000000000000, gasLimit=313921, gasPrice=79444034756, gasUsed=226936, blockNumber=13898509, blockHash='0x0ad4d72b353a6232b69e72bb270457fd4f3c640e40483744d0f0b9997dc2e4e8', blockDate=datetime.datetime(2021, 12, 29, 7, 5, 3)), 
        RetrievedTokenTransfer(transactionHash='0xf46f8b6647a7f796260a128ad36ff728a59c8fab5b80538275549cc79e9a8743', registryAddress='0xC36442b4a4522E871399CD717aBDD847Ab11FE88', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x2480F754530776cFe59bBf26776345AB370eE36A', tokenId='174980', value=9000000000000000000, gasLimit=603351, gasPrice=79444034756, gasUsed=474875, blockNumber=13898509, blockHash='0x0ad4d72b353a6232b69e72bb270457fd4f3c640e40483744d0f0b9997dc2e4e8', blockDate=datetime.datetime(2021, 12, 29, 7, 5, 3)), 
        RetrievedTokenTransfer(transactionHash='0xad3bef8676feb8639015f44e56a683ca19d63313fe22d060af8d09c1f89a6a81', registryAddress='0xB6fB14caa60A6b576860959f12AA2D3A8089caa9', fromAddress='0x23d2B5a96528B63dbcFe49F8CEB11Cbe27F6D527', toAddress='0x81c257f559196aE212776c47044dd082858A11DA', tokenId='1009', value=190000000000000000, gasLimit=259639, gasPrice=79444034756, gasUsed=194781, blockNumber=13898509, blockHash='0x0ad4d72b353a6232b69e72bb270457fd4f3c640e40483744d0f0b9997dc2e4e8', blockDate=datetime.datetime(2021, 12, 29, 7, 5, 3)), 
        RetrievedTokenTransfer(transactionHash='0xaf6d8eb8f567e4a8b66039458ae1ad4ccc8d4e07ab8000b81de02b2488902553', registryAddress='0x45DB714f24f5A313569c41683047f1d49e78Ba07', fromAddress='0x6536590E019Cf82355366483f90dc56D2cBc00Ba', toAddress='0xe30fCec8AfCCDFbD7c41686131D40a710A0780D1', tokenId='5535', value=0, gasLimit=107898, gasPrice=79444034756, gasUsed=98298, blockNumber=13898509, blockHash='0x0ad4d72b353a6232b69e72bb270457fd4f3c640e40483744d0f0b9997dc2e4e8', blockDate=datetime.datetime(2021, 12, 29, 7, 5, 3)), 
        RetrievedTokenTransfer(transactionHash='0xa1a2bdc9738a39258a6f3dc3a4b34c2dd14b15cd90a3509419d4d07659785d1b', registryAddress='0x6468f4243Faa8C3330bAAa0a7a138E2e5628C6f5', fromAddress='0xec2018321913a1AF4834D21790A18a87fDaa643C', toAddress='0x2d442036dACF7D8BE18CE8cec29E64E1918D9Fc5', tokenId='2384', value=209000000000000000, gasLimit=229361, gasPrice=79444034756, gasUsed=171490, blockNumber=13898509, blockHash='0x0ad4d72b353a6232b69e72bb270457fd4f3c640e40483744d0f0b9997dc2e4e8', blockDate=datetime.datetime(2021, 12, 29, 7, 5, 3))
    ]
    assert result == expected

if __name__ == '__main__':
    logging.basicConfig(level=logging.INFO)
    asyncio.run(main())
