import datetime
import os
import sys
import unittest
from typing import List
from unittest import IsolatedAsyncioTestCase

from core.aws_requester import AwsRequester
from core.requester import Requester
from core.web3.eth_client import EthClientInterface
from core.web3.eth_client import RestEthClient
from web3.types import TxData

sys.path.insert(0, os.path.dirname(os.path.dirname(__file__)))
from notd.block_processor import BlockProcessor
from notd.model import ProcessedBlock
from notd.model import RetrievedTokenTransfer


async def _get_transaction(ethClient: EthClientInterface, blockNumber: int, transactionHash: str) -> TxData:
    blockData = await ethClient.get_block(blockNumber=blockNumber, shouldHydrateTransactions=True)
    transaction = next((transaction for transaction in blockData['transactions'] if transaction['hash'].hex() == transactionHash), None)
    return transaction

async def get_transaction_retrieved_events(blockProcessor: BlockProcessor, blockNumber: int, transactionHash: str):
    transactionHashEventMap = await blockProcessor._get_retrieved_events(blockNumber=blockNumber)
    return transactionHashEventMap[transactionHash]

class KibaAsyncTestCase(IsolatedAsyncioTestCase):

    def __init__(self, methodName: str = 'runTest') -> None:
        super().__init__(methodName=methodName)


class BlockProcessorTestCase(KibaAsyncTestCase):

    maxDiff = None

    async def asyncSetUp(self) -> None:
        await super().asyncSetUp()
        # self.awsRequester = AwsRequester(accessKeyId=os.environ['AWS_KEY'], accessKeySecret=os.environ['AWS_SECRET'])
        # self.ethClient = RestEthClient(url='https://nd-foldvvlb25awde7kbqfvpgvrrm.ethereum.managedblockchain.eu-west-1.amazonaws.com', requester=self.awsRequester)
        self.requester = Requester()
        self.ethClient = RestEthClient(url=f'https://mainnet.infura.io/v3/{os.environ["INFURA_PROJECT_ID"]}', requester=self.requester)
        self.blockProcessor = BlockProcessor(ethClient=self.ethClient)

    async def asyncTearDown(self) -> None:
        # await self.awsRequester.close_connections()
        await self.requester.close_connections()
        await super().asyncTearDown()


class TestProcessBlock(BlockProcessorTestCase):

    async def test_1(self):
        result = await self.blockProcessor.process_block(13281280)
        expected = ProcessedBlock(
            blockNumber=13281280,
            blockHash='0x79da1d97baead833e2b4e597a24d08a0e5efddd2c7f0983f776836a8ffb03d4c',
            blockDate=datetime.datetime(2021, 9, 23, 9, 50, 9),
            retrievedTokenTransfers=[ 
                RetrievedTokenTransfer(transactionHash='0x3a59e929b3dcdfd412ee35cb0d88a9b13693e38869d976bef92569e249b89dee', registryAddress='0x33825285eB66c11237Cc68CC182c1e9BF01bA00B', tokenId='4973', fromAddress='0x857784eA852149c21aD6025E94b715E753Cc2124', toAddress='0xF8ca0a9aAdfBD7470B77DB6D2498CDE243ba8420', operatorAddress='0xF8ca0a9aAdfBD7470B77DB6D2498CDE243ba8420', amount=1, value=164900000000000000, gasLimit=236924, gasPrice=58300000000, blockNumber=13281280, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xf1f0758d54474efb810e470592349703adc758c5037e56ae1bd6a789e9a079ef', registryAddress='0x2216d47494E516d8206B70FCa8585820eD3C4946', tokenId='14364', fromAddress='0xffF8f66e26ac1A75F2b5Da49c247f3Ec0D0EA5ba', toAddress='0x0000000000000000000000000000000000080085', operatorAddress='0xffF8f66e26ac1A75F2b5Da49c247f3Ec0D0EA5ba', amount=1, value=0, gasLimit=449751, gasPrice=48786337690, blockNumber=13281280, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0xf1f0758d54474efb810e470592349703adc758c5037e56ae1bd6a789e9a079ef', registryAddress='0x2216d47494E516d8206B70FCa8585820eD3C4946', tokenId='10626', fromAddress='0xffF8f66e26ac1A75F2b5Da49c247f3Ec0D0EA5ba', toAddress='0x0000000000000000000000000000000000080085', operatorAddress='0xffF8f66e26ac1A75F2b5Da49c247f3Ec0D0EA5ba', amount=1, value=0, gasLimit=449751, gasPrice=48786337690, blockNumber=13281280, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0xf1f0758d54474efb810e470592349703adc758c5037e56ae1bd6a789e9a079ef', registryAddress='0x2216d47494E516d8206B70FCa8585820eD3C4946', tokenId='10627', fromAddress='0xffF8f66e26ac1A75F2b5Da49c247f3Ec0D0EA5ba', toAddress='0x0000000000000000000000000000000000080085', operatorAddress='0xffF8f66e26ac1A75F2b5Da49c247f3Ec0D0EA5ba', amount=1, value=0, gasLimit=449751, gasPrice=48786337690, blockNumber=13281280, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0x355f53288cb9d9b91012470d681bd3453c5253d54f2becb17d20e4347432ce09', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', tokenId='32227014266187574693694258784543567127334353629417101029986949134666818388768', fromAddress='0x473fD7FB5826D0CB76903c8bFb5E8E0f1a717626', toAddress='0xCCa178a04D83Af193330C7927fb9a42212Fb1C25', operatorAddress='0x8945F51c47e1B2406f4D96c3E795010A59B954eb', amount=1, value=500000000000000000, gasLimit=271893, gasPrice=46221801906, blockNumber=13281280, tokenType='erc1155single', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xfb9e13d47dc451e8c080245488771a5589bc1e461a2911c8dcfd713267df5dbc', registryAddress='0xF8C08433DD41eAeE2e424C9E91467aB27772d9ec', tokenId='97', fromAddress='0x44F360a7771888B5Ad92677D795aA10EA88203CA', toAddress='0x62F56981d431e68B5CAb37ae3A242a72824D3ac7', operatorAddress='0x44F360a7771888B5Ad92677D795aA10EA88203CA', amount=1, value=0, gasLimit=60316, gasPrice=46000000000, blockNumber=13281280, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0x3234d993232494cb0ac88ed94580e7c23b2291629c5321acb3793d51d732dc79', registryAddress='0xF1F3ca6268f330fDa08418db12171c3173eE39C9', tokenId='8', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x5B1A00402c6aaBC799aa30d009Fb26ec7980BA0a', operatorAddress='0x5B1A00402c6aaBC799aa30d009Fb26ec7980BA0a', amount=2, value=0, gasLimit=62020, gasPrice=46000000000, blockNumber=13281280, tokenType='erc1155single', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x786dedd3df009705c246629c864e839b78b897319d346540f10bb84dabbacbb4', registryAddress='0xC00d444eeD049ad0d858a4A8D6Cac5417054405D', tokenId='1681', fromAddress='0x089660619d26b6CA62EaCD74e2DdD6089024fcCc', toAddress='0xa1F39F1a900A44DDFC702f9071808a07B841f377', operatorAddress='0xa1F39F1a900A44DDFC702f9071808a07B841f377', amount=1, value=9000000000000000, gasLimit=331269, gasPrice=45871801906, blockNumber=13281280, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xc23496871eaf21f0bcbb7a10fa449e1d0f307b1f4493c12d6a4009d21a73d4dd', registryAddress='0x9f75A77966ADE660782f73f822c836C32BE6784a', tokenId='41', fromAddress='0xA09e8346B1F58F49622C81B7B1fe26441f0a8f28', toAddress='0x2953399124F0cBB46d2CbACD8A89cF0599974963', operatorAddress='0xA09e8346B1F58F49622C81B7B1fe26441f0a8f28', amount=1, value=0, gasLimit=57213, gasPrice=45721801906, blockNumber=13281280, tokenType='erc1155single', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0x35bf97445892e633811b0251cba7056f0f6d00d127b38e3414f9b219839a0d5a', registryAddress='0x06012c8cf97BEaD5deAe237070F9587f8E7A266d', tokenId='938228', fromAddress='0xb1690C08E213a35Ed9bAb7B318DE14420FB57d8C', toAddress='0x52b2A1cc5BF5701408A0aAB889fB5ab2Cf65275b', operatorAddress='0x52b2A1cc5BF5701408A0aAB889fB5ab2Cf65275b', amount=1, value=19857666997354496, gasLimit=168463, gasPrice=45721801906, blockNumber=13281280, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x5f240c53fafdf13e16ea02c3e94b8daec4c0d36272ea5cc639a211e344afd6c8', registryAddress='0xa64C5EC80784675bf289A4722a2eca180212f9dB', tokenId='1718', fromAddress='0x57B386815E928BBF43aB16cfD7f268E7f861c0AA', toAddress='0xf3E09Fa1754c77aECe0808197b2cAAE896b1C3eD', operatorAddress='0xf3E09Fa1754c77aECe0808197b2cAAE896b1C3eD', amount=1, value=50000000000000000, gasLimit=312990, gasPrice=45721801906, blockNumber=13281280, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xd913164a0166140027e68fad832d1942cde756709c778697844f9ab10eb35e4c', registryAddress='0xC36442b4a4522E871399CD717aBDD847Ab11FE88', tokenId='130999', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x6B33a55786b2412c5283bfFc0383Ca35D702B388', operatorAddress='0x6B33a55786b2412c5283bfFc0383Ca35D702B388', amount=1, value=479676176628488576, gasLimit=626642, gasPrice=45681801906, blockNumber=13281280, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False)
            ]
        )
        assert(result == expected)

    async def test_2(self):
        result = await self.blockProcessor.process_block(12839305)
        expected = ProcessedBlock(
            blockNumber=12839305,
            blockHash='0x7e36a9f127f3413595ef0f1c4165e4547d20ab566b66fc51a3cbe9eb048f3154',
            blockDate=datetime.datetime(2021, 7, 16, 17, 41, 41),
            retrievedTokenTransfers=[
                RetrievedTokenTransfer(transactionHash='0x610b0e54f476ecada3fcc5afe330e967b0f8cc22dafa4cd1983f0f2a204bead3', registryAddress='0xd07dc4262BCDbf85190C01c996b4C06a461d2430', tokenId='640491', fromAddress='0xe46ec6498B186AaA8C2222c703c463982734D01A', toAddress='0x7AFB8fAC50362DDf276df66a8010ff032BBE1345', operatorAddress='0x4feE7B061C97C9c496b01DbcE9CDb10c02f0a0Be', amount=18, value=1826550000000000000, gasLimit=329641, gasPrice=40000000000, blockNumber=12839305, tokenType='erc1155single', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xfc8ffb7652d77c1b880a80134bdce050c9bf712610fa9dc0d3d3fa83c10d3a1b', registryAddress='0xFBB6684EbD6093989740e8ef3e7D57cf3813E5a4', tokenId='9991', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x18090cDA49B21dEAffC21b4F886aed3eB787d032', operatorAddress='0x18090cDA49B21dEAffC21b4F886aed3eB787d032', amount=1, value=0, gasLimit=184165, gasPrice=40000000000, blockNumber=12839305, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x3093bb2c8cbf1d229594d2cb8b172558fb6730721d9ef561b6400543a59f3734', registryAddress='0x049aba7510f45BA5b64ea9E658E342F904DB358D', tokenId='111875105896522767201998009571114989808106447240989160672650322275489228602620', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x54A5A62D34d3C55Cb35Bb8B4d4C958c820c5f322', operatorAddress='0x54A5A62D34d3C55Cb35Bb8B4d4C958c820c5f322', amount=1, value=0, gasLimit=147908, gasPrice=40000000000, blockNumber=12839305, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x7d15427902a0ae5cb45b20cb38ab4ef0aab204ba1e4ae120f2b3b4d1c40cb688', registryAddress='0x395E5461693e0bB5EC78302605030050f69e628d', tokenId='1861', fromAddress='0x913C7fa57e6690f96B4AEB65553f0ED3664CAF8b', toAddress='0xA8E3582964ffA96621a767468b1D66207211df00', operatorAddress='0x913C7fa57e6690f96B4AEB65553f0ED3664CAF8b', amount=1, value=0, gasLimit=97681, gasPrice=40000000000, blockNumber=12839305, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0x9e52523fc2de27af5e927d20a5b895024c46d7e9cebe758303c9768c3f756c19', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', tokenId='99683587586696680377209091673774721318238762396163454333212325529815842029569', fromAddress='0xDc62e941fDDBDdDFc666B133E24E0C1aFae11847', toAddress='0xC4e245226537A0B1c5AF30079Eb0251504b42793', operatorAddress='0x750a32FAB9AE3B4ba3c15fF3d140b19aC92f25D8', amount=1, value=50000000000000000, gasLimit=228450, gasPrice=40000000000, blockNumber=12839305, tokenType='erc1155single', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False)
            ]
        )
        assert(result == expected)

    async def test_3(self):
        result = await self.blockProcessor.process_block(13281282)
        expected = ProcessedBlock(
            blockNumber=13281282,
            blockHash='0x108e517707682f2a20b883f452ad9100528ca6458e3f3e74d33b36fbc5b46fd9',
            blockDate=datetime.datetime(2021, 9, 23, 9, 50, 40),
            retrievedTokenTransfers=[
                RetrievedTokenTransfer(transactionHash='0x36c5004fc6279dd2c213626d841cafea4e2f69d1c03267211f01fde295ec23a1', registryAddress='0xbe6e3669464E7dB1e1528212F0BfF5039461CB82', tokenId='640', fromAddress='0xa0EfBA909AFb7D8B284cA95Df6BEce062575df03', toAddress='0xE24b69F465eAD3c5De169E73b524f0e95BBC2233', operatorAddress='0xa0EfBA909AFb7D8B284cA95Df6BEce062575df03', amount=1, value=0, gasLimit=387696, gasPrice=60500000000, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0x232ff4966ecb9b17f48fb04ad89a9dbc6b98403b2a4a63df95bbc693343405c9', registryAddress='0xdf9Aa1012Fa49DC1d2a306e3e65EF1797d2b5fBb', tokenId='95587', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x9317d29f94f9f399ED27048a14bBaE81D7fd73fB', operatorAddress='0xF6A978aB977615eDd6E2299758aE9aedB9c25a7f', amount=1, value=0, gasLimit=300000, gasPrice=60342876911, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x6ff77bdef9dcb019179f07e1d53fd437faade539c2cde62582d9181606a2f2ae', registryAddress='0xdf9Aa1012Fa49DC1d2a306e3e65EF1797d2b5fBb', tokenId='95584', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x9317d29f94f9f399ED27048a14bBaE81D7fd73fB', operatorAddress='0x917BfDd1572AccCA46237f4388460393d7b4AAe8', amount=1, value=0, gasLimit=300000, gasPrice=60342876911, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xb7a942ac2f946930195af1aac801ef426d04fddb371b286765d338749cbabd3d', registryAddress='0xdf9Aa1012Fa49DC1d2a306e3e65EF1797d2b5fBb', tokenId='95578', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x9317d29f94f9f399ED27048a14bBaE81D7fd73fB', operatorAddress='0x0a75FeC70876E12FD6417E1091d6b4d5d83a6Af4', amount=1, value=0, gasLimit=300000, gasPrice=55987064157, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x6473d8350cd1f3cc403103ae40ea6e4dcafb2533667cd5cabcdc84184ed4830a', registryAddress='0xdf9Aa1012Fa49DC1d2a306e3e65EF1797d2b5fBb', tokenId='95583', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x9317d29f94f9f399ED27048a14bBaE81D7fd73fB', operatorAddress='0xfca7E99a3cA579a0111b908BfdfE498BbF52A2FB', amount=1, value=0, gasLimit=300000, gasPrice=55000000000, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x41101638e36f6b95de958db91ea584064be8dc2cdf8f302f16b71b3ce7536d00', registryAddress='0xC0cf5B82Ae2352303b2EA02c3bE88e23f2594171', tokenId='22700083048', fromAddress='0xE052113bd7D7700d623414a0a4585BCaE754E9d5', toAddress='0x88D5F4AC2d78d74076A80402B63d8bBf3412aDaA', operatorAddress='0xE052113bd7D7700d623414a0a4585BCaE754E9d5', amount=1, value=0, gasLimit=161103, gasPrice=53900000000, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0xc34b3cf19e00814f37ed2d93a0fa0a21a3d061f955d61b21f89df64b3e6cd209', registryAddress='0x335eEEF8e93A7A757D9e7912044d9cd264e2b2D8', tokenId='3857', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x4d99D5C7698D69F02f2CAC5532258cd80485B29f', operatorAddress='0x4d99D5C7698D69F02f2CAC5532258cd80485B29f', amount=1, value=70000000000000000, gasLimit=240993, gasPrice=52862462303, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xb6adbd489a825f0da1b58be6122b0157a7c85d5b8bfa08f6683b7ebbdadb1421', registryAddress='0x6dFCB04b7d2aB2069d9ba81aC643556429EB2d55', tokenId='5983', fromAddress='0x09A3Ed4C3B477E53850edE0AAC96681BA314193B', toAddress='0x364F53FDc05AFBccd4db2053cE912840E8f08D9D', operatorAddress='0x364F53FDc05AFBccd4db2053cE912840E8f08D9D', amount=1, value=30000000000000000, gasLimit=303158, gasPrice=50291118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x483b2c81d0359c4dc12b60a249e98b0ad82da2ad50348b6eeb2ba851918caec1', registryAddress='0x225301b500678E15A64B59609D8e00C2413AB426', tokenId='1', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', operatorAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', amount=1, value=0, gasLimit=1000000, gasPrice=50000000000, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x483b2c81d0359c4dc12b60a249e98b0ad82da2ad50348b6eeb2ba851918caec1', registryAddress='0x225301b500678E15A64B59609D8e00C2413AB426', tokenId='2', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', operatorAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', amount=1, value=0, gasLimit=1000000, gasPrice=50000000000, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x483b2c81d0359c4dc12b60a249e98b0ad82da2ad50348b6eeb2ba851918caec1', registryAddress='0x225301b500678E15A64B59609D8e00C2413AB426', tokenId='3', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', operatorAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', amount=1, value=0, gasLimit=1000000, gasPrice=50000000000, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x483b2c81d0359c4dc12b60a249e98b0ad82da2ad50348b6eeb2ba851918caec1', registryAddress='0x225301b500678E15A64B59609D8e00C2413AB426', tokenId='4', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', operatorAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', amount=1, value=0, gasLimit=1000000, gasPrice=50000000000, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x483b2c81d0359c4dc12b60a249e98b0ad82da2ad50348b6eeb2ba851918caec1', registryAddress='0x225301b500678E15A64B59609D8e00C2413AB426', tokenId='5', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', operatorAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', amount=1, value=0, gasLimit=1000000, gasPrice=50000000000, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x483b2c81d0359c4dc12b60a249e98b0ad82da2ad50348b6eeb2ba851918caec1', registryAddress='0x225301b500678E15A64B59609D8e00C2413AB426', tokenId='6', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', operatorAddress='0x0FE7C97d52D49a6249Ac4FFab6e8E700b1c7E22D', amount=1, value=0, gasLimit=1000000, gasPrice=50000000000, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x418a1da25db4e610b1acfba1fdd52556d6f3c3c53cea639b6de1b68a1ead9fcf', registryAddress='0x05a46f1E545526FB803FF974C790aCeA34D1f2D6', tokenId='6403', fromAddress='0xB0ebEeAc1a25CC7Ba8e429D5f8fA911de3f2672B', toAddress='0x08543f4c79f7e5d585A2622cA485e8201eFd9aDA', operatorAddress='0xB0ebEeAc1a25CC7Ba8e429D5f8fA911de3f2672B', amount=1, value=0, gasLimit=161350, gasPrice=49791118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0xc1d0b54d0d61ced4a2ad2fe53acd4537f00c528e3984c21ec365564b41fd7218', registryAddress='0x6dFCB04b7d2aB2069d9ba81aC643556429EB2d55', tokenId='5863', fromAddress='0xc5a1a4863eB957021aa4F1Ba4aB02549059aEa5B', toAddress='0xB3c526d61aDd017084ECE11f6CB72893387520D8', operatorAddress='0xB3c526d61aDd017084ECE11f6CB72893387520D8', amount=1, value=50000000000000000, gasLimit=303158, gasPrice=49791118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', tokenId='92239469154549493527197540724254834850645073994564312704917306496371006636033', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155single', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', tokenId='92239469154549493527197540724254834850645073994564312704917306499669541519361', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155single', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', tokenId='92239469154549493527197540724254834850645073994564312704917306510664657797121', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155single', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', tokenId='92239469154549493527197540724254834850645073994564312704917306588729983369217', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155single', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0xd07dc4262BCDbf85190C01c996b4C06a461d2430', tokenId='514337', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155single', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', tokenId='92239469154549493527197540724254834850645073994564312704917306630511425224705', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155single', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', tokenId='92239469154549493527197540724254834850645073994564312704917306633809960108047', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155single', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', tokenId='92239469154549493527197540724254834850645073994564312704917306678889936846863', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155single', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', tokenId='80494307024529346018053650490912529916739680814770830097664395766818859384898', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155single', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', tokenId='80494307024529346018053650490912529916739680814770830097664395774515440779395', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155single', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', tokenId='80494307024529346018053650490912529916739680814770830097664395786610068684830', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155single', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0xda8be4629cc9207704ef93d3680bdfaaa59fc54f3e991467f0d9b187d1bdbb89', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', tokenId='80494307024529346018053650490912529916739680814770830097664395791008115195927', fromAddress='0xA6FE71927B49147d8Adf5526B7416E0adF824004', toAddress='0x6b08FD9d36f7e29c2Aaf178918b9D3dd5E257FaF', operatorAddress='0x1419cc56221b5480d52a79E59eD27F50ACD56dED', amount=1, value=0, gasLimit=1166618, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155single', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0x50505ac66dfc62345a0da374ccc0d298427338bb5320d2b9ba3c762f86f71af7', registryAddress='0x25C65721E26fa5F3c97f129F4e24972482327BC9', tokenId='4461', fromAddress='0xeb6f1a21B99FaDb73C4bA4331D71360918723eb7', toAddress='0xF20A3c4781c5726ea011Fa869e3C5aA4dddb9882', operatorAddress='0xF20A3c4781c5726ea011Fa869e3C5aA4dddb9882', amount=1, value=59000000000000000, gasLimit=294506, gasPrice=49791118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x8ed68004e9df484dae1ecbd6211b99b88d551a05cfefcafdd29b63fc43863d89', registryAddress='0x6dFCB04b7d2aB2069d9ba81aC643556429EB2d55', tokenId='3162', fromAddress='0x335f82268d54807104561ceA27900A0CC913a8A2', toAddress='0xAa6B43b77b4Df6ccCd971699a54b4e2866389a43', operatorAddress='0xAa6B43b77b4Df6ccCd971699a54b4e2866389a43', amount=1, value=39000000000000000, gasLimit=316781, gasPrice=49791118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xb13c78498968568e626ac492847a29badae7e5805efd8b0d0169ba6e8c58b524', registryAddress='0xa7eE407497b2Aeb43580cabe2B04026b5419D1dc', tokenId='9691', fromAddress='0xBdD95ABE8a7694CCD77143376b0fBea183E6a740', toAddress='0x571ad36DeD93eC62df5deBa152352DE69C720056', operatorAddress='0x571ad36DeD93eC62df5deBa152352DE69C720056', amount=1, value=84900000000000000, gasLimit=262066, gasPrice=49791118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x0ee725c58965572507270564cec4c2037c96d07dc47ad3aa1e632c6601c39952', registryAddress='0x73DA73EF3a6982109c4d5BDb0dB9dd3E3783f313', tokenId='7', fromAddress='0x015F08Af4Fe34e94BF363034b62033FE5167eC32', toAddress='0x6eADc94432fBfF59836959bb38F0cD34Bf50781B', operatorAddress='0x015F08Af4Fe34e94BF363034b62033FE5167eC32', amount=1, value=0, gasLimit=56514, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155single', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0x64ef1bc3f512db177bce74600c94f5e3dad853c41c4121b28777f5b0296848f6', registryAddress='0x3AF65d01F6CDe41965a2D591BB399C8f0Db76AFd', tokenId='227', fromAddress='0xaa114724F2bCBD859d01585435E3076671314D2E', toAddress='0x4E9fD21519Cf3D1FeA8c0deBbB9F91814A3D0d62', operatorAddress='0x4E9fD21519Cf3D1FeA8c0deBbB9F91814A3D0d62', amount=1, value=36900000000000000, gasLimit=301243, gasPrice=49791118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xbeee7c21a2fed8f99adc89b890d3bd1a3cb0591e54d161fb63ce51a2096152e1', registryAddress='0xd153f0014db6d1F339c6340d2C9F59214355D9d7', tokenId='6326', fromAddress='0x6d311DC526D59edEc79e03fcab01B8e0a5d60dAC', toAddress='0x2C507ED5B4857B54d7235393ac8B36ec7E84b6E6', operatorAddress='0x2C507ED5B4857B54d7235393ac8B36ec7E84b6E6', amount=1, value=249000000000000000, gasLimit=301385, gasPrice=49791118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xda0fbfacc71f881b57cf5a47c774ec6ca7aaa685352b3c89bbaff9fd88f71487', registryAddress='0xF8C08433DD41eAeE2e424C9E91467aB27772d9ec', tokenId='1961', fromAddress='0x351AFD0681282aD0f9eF609aCFA1Ec2418082036', toAddress='0xDE60BCc0F87564F4f4309a241Ad9c9d762c43b12', operatorAddress='0x351AFD0681282aD0f9eF609aCFA1Ec2418082036', amount=1, value=0, gasLimit=46409, gasPrice=49791118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0x3b5a997a6f9c0dca5b038e4a5edb67dbace029760fbcf3561e6dc66c31a7ea81', registryAddress='0xC2C747E0F7004F9E8817Db2ca4997657a7746928', tokenId='7759', fromAddress='0xB776624bb2302Ef3499B5F8E2e75B55165cc7a6D', toAddress='0xc8581bFFFa683B205A6799A9D26fF197Ccb33117', operatorAddress='0xB776624bb2302Ef3499B5F8E2e75B55165cc7a6D', amount=1, value=0, gasLimit=117277, gasPrice=49791118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0x40ca42957f1f532064f0c479c3dd229d33b7d5d58d674794f4ef6a89353d9d07', registryAddress='0xf3DFbE887D81C442557f7a59e3a0aEcf5e39F6aa', tokenId='7948', fromAddress='0xBC244D31a3686F8f60224A86067D979BFA926BA0', toAddress='0x1bC836F5844C4e257D19f11DA540b051aA550AA4', operatorAddress='0x1bC836F5844C4e257D19f11DA540b051aA550AA4', amount=1, value=80000000000000000, gasLimit=301170, gasPrice=49791118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x2d8423aac26c4b856f216294d35f4a6eb94f09d0baa3880828af3cdfe97b46de', registryAddress='0x71355f4a94f46eE32EB443aD2BDE2DeC0470f949', tokenId='134', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', operatorAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', amount=1, value=0, gasLimit=416281, gasPrice=49791118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x2d8423aac26c4b856f216294d35f4a6eb94f09d0baa3880828af3cdfe97b46de', registryAddress='0x9b51A88Cffe9B50E043661ddD7F492cc3888fcbF', tokenId='51539804160', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', operatorAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', amount=1, value=0, gasLimit=416281, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155batch', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x2d8423aac26c4b856f216294d35f4a6eb94f09d0baa3880828af3cdfe97b46de', registryAddress='0x9b51A88Cffe9B50E043661ddD7F492cc3888fcbF', tokenId='196609', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', operatorAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', amount=1, value=0, gasLimit=416281, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155batch', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x2d8423aac26c4b856f216294d35f4a6eb94f09d0baa3880828af3cdfe97b46de', registryAddress='0x9b51A88Cffe9B50E043661ddD7F492cc3888fcbF', tokenId='458754', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', operatorAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', amount=1, value=0, gasLimit=416281, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155batch', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x2d8423aac26c4b856f216294d35f4a6eb94f09d0baa3880828af3cdfe97b46de', registryAddress='0x9b51A88Cffe9B50E043661ddD7F492cc3888fcbF', tokenId='589827', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', operatorAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', amount=1, value=0, gasLimit=416281, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155batch', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x2d8423aac26c4b856f216294d35f4a6eb94f09d0baa3880828af3cdfe97b46de', registryAddress='0x9b51A88Cffe9B50E043661ddD7F492cc3888fcbF', tokenId='786436', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', operatorAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', amount=1, value=0, gasLimit=416281, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155batch', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x2d8423aac26c4b856f216294d35f4a6eb94f09d0baa3880828af3cdfe97b46de', registryAddress='0x9b51A88Cffe9B50E043661ddD7F492cc3888fcbF', tokenId='720901', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', operatorAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', amount=1, value=0, gasLimit=416281, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155batch', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x2d8423aac26c4b856f216294d35f4a6eb94f09d0baa3880828af3cdfe97b46de', registryAddress='0x9b51A88Cffe9B50E043661ddD7F492cc3888fcbF', tokenId='8590065670', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', operatorAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', amount=1, value=0, gasLimit=416281, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155batch', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x2d8423aac26c4b856f216294d35f4a6eb94f09d0baa3880828af3cdfe97b46de', registryAddress='0x9b51A88Cffe9B50E043661ddD7F492cc3888fcbF', tokenId='55834640391', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', operatorAddress='0xFeecc1Ae5C6E8739d94DA2e9f3A1fD140333dDC7', amount=1, value=0, gasLimit=416281, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155batch', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x4550fdb52840250fa9fc914ea03a6659257b34ef5674b4b0d88f5e8ae17d82d3', registryAddress='0x1D20A51F088492A0f1C57f047A9e30c9aB5C07Ea', tokenId='2852', fromAddress='0xE2008Ef79a7d0D75EdAE70263384D4aC5D1A9f9A', toAddress='0xDAAe53f14dc00b383068156dB3464E76a2fdb7C1', operatorAddress='0xDAAe53f14dc00b383068156dB3464E76a2fdb7C1', amount=1, value=1400000000000000000, gasLimit=297281, gasPrice=49791118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xd472f726343a30e1fa6b57d89a8463849ef5e7fb87b38a65dc1acf456270947e', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', tokenId='32227014266187574693694258784543567127334353629417101029986949134666818388768', fromAddress='0x473fD7FB5826D0CB76903c8bFb5E8E0f1a717626', toAddress='0xeBD9BB8bb470051339a7F13AB6842397B9cD6254', operatorAddress='0x8945F51c47e1B2406f4D96c3E795010A59B954eb', amount=1, value=500000000000000000, gasLimit=249647, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155single', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xa1da8fe2261591da0fefe5bca78a4c2dc7f6efb76b4c3fdca9adc85d4b1f8cbb', registryAddress='0x9f4292bd05a5c89F007bDeF3a95fC32bc1021b99', tokenId='9651', fromAddress='0x36B049dAC44B130879C10f36C9031cd36b8cA08C', toAddress='0xEB3f24f3cD709Fa3A1eDE5f1C11aA93b8741d32C', operatorAddress='0x36B049dAC44B130879C10f36C9031cd36b8cA08C', amount=1, value=0, gasLimit=104703, gasPrice=49791118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0x95c775d6e2ad6cd338df87f60ef2826b218c82bb7b3d182b5e427e3907fce234', registryAddress='0x3a8778A58993bA4B941f85684D74750043A4bB5f', tokenId='2014', fromAddress='0x0fA36ea577AD67C61e0b7631C55BD305533B8C94', toAddress='0x6E81aF1BcD504a51Da5BD6A0d7DF70D7674CE90E', operatorAddress='0x0fA36ea577AD67C61e0b7631C55BD305533B8C94', amount=1, value=0, gasLimit=94599, gasPrice=49791118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0x006d45c631a8be9b77cb40f161963af4e004f4b319f545d8d1bf23469c9c5e8f', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', tokenId='7826956463027448225520519187082793484908476728102208308696043473228661784577', fromAddress='0x114DE67e89Ca25767a6aec9430129FeE58eFF8Ad', toAddress='0x2d6bC5b701812107D4bFe5C24024bE7A173AB143', operatorAddress='0x0a1819D0858A1C2eCEfe424342B9fA0b812B7507', amount=1, value=100000000000000000, gasLimit=294652, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155single', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xf4279c8e88f0fdb215d829462b76e4c2d2e1f2af8947de818cd8e8640a9c287c', registryAddress='0xE885d519025348e30174A218BE3e3E4754222860', tokenId='2', fromAddress='0xd815FEaeb858838690440F7298Eb0465b27a7Ff4', toAddress='0xF4d197E35ee93B3C72bAf817172C4F48F4727240', operatorAddress='0x19932899084A9C608d3C633E1A23a27f4734074D', amount=1, value=310000000000000000, gasLimit=233417, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155single', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x95addcc09c4236fee5280bbdd2e74d830566430acd5c3438b308bcac49c7349c', registryAddress='0x3B3ee1931Dc30C1957379FAc9aba94D1C48a5405', tokenId='89793', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xfaB40a7F7de738469Dbe19C9763AC47a458314F2', operatorAddress='0xfaB40a7F7de738469Dbe19C9763AC47a458314F2', amount=1, value=0, gasLimit=336828, gasPrice=49791118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x2363ae2de6b0718175b27e44431273bb5e5e876ace028535e36d3251c18f1742', registryAddress='0x52607cb9c342821ea41ad265B9Bb6a23BEa49468', tokenId='3581', fromAddress='0x9516d0145eD67839646AcDdBDd344E6708130C15', toAddress='0xc134eb26CAC544A24a97B0D108DC36E7E41172Ad', operatorAddress='0xc134eb26CAC544A24a97B0D108DC36E7E41172Ad', amount=1, value=39000000000000000, gasLimit=307601, gasPrice=49791118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xdb417a316d587977fe02147c58964a0c23cb642f0b67fca7f334797d7d9e13d7', registryAddress='0xa7d8d9ef8D8Ce8992Df33D8b8CF4Aebabd5bD270', tokenId='130000412', fromAddress='0x6e54630b1C6961A75Bc6337e4E732Cb2c74d7a7A', toAddress='0x73857350FF2e6882253CccC1a1d2d2ae6EA4ea84', operatorAddress='0x6e54630b1C6961A75Bc6337e4E732Cb2c74d7a7A', amount=1, value=0, gasLimit=266544, gasPrice=49791118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0xdb417a316d587977fe02147c58964a0c23cb642f0b67fca7f334797d7d9e13d7', registryAddress='0xa7d8d9ef8D8Ce8992Df33D8b8CF4Aebabd5bD270', tokenId='134000057', fromAddress='0x6e54630b1C6961A75Bc6337e4E732Cb2c74d7a7A', toAddress='0x73857350FF2e6882253CccC1a1d2d2ae6EA4ea84', operatorAddress='0x6e54630b1C6961A75Bc6337e4E732Cb2c74d7a7A', amount=1, value=0, gasLimit=266544, gasPrice=49791118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0x3a90f87bf49ee4ae243589732abfc6f15968c53a396ee868c7d17f0efc94218d', registryAddress='0xFAFf15C6cDAca61a4F87D329689293E07c98f578', tokenId='5', fromAddress='0x9ef4ACc2Fd5cde01ECe05BD4e44732a023ed7845', toAddress='0x9ef4ACc2Fd5cde01ECe05BD4e44732a023ed7845', operatorAddress='0x9ef4ACc2Fd5cde01ECe05BD4e44732a023ed7845', amount=1, value=0, gasLimit=32364, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155single', isMultiAddress=False, isInterstitial=False, isSwap=True, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0x32138904d651a006dbbed36f1c7239c8a0feb7d6941d6ce74a36e0c10ea95ff0', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', tokenId='108348005865544129040411552508209223114542272553772717755275978878399503400961', fromAddress='0xEf8ACC51b6411af79FFdaD8182394F0d7792445b', toAddress='0xEbA16886d5fAF77A608B569C5a2520A0875b55aF', operatorAddress='0x1afA7E683fA180630329A982b3fe5457404Fa78B', amount=1, value=133700000000000000, gasLimit=294466, gasPrice=49791118272, blockNumber=13281282, tokenType='erc1155single', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x6aeddc15c90548604194c9b7bca7cdbedb7e5624045bbdf47410b20448658c16', registryAddress='0xF407B994F05d2b2cA66534517a9C85a117Db54A5', tokenId='1732', fromAddress='0xf11DCB438Ef856C536979B00d971F1A3AFE289cC', toAddress='0xc4C2E9FFB56efdD80cF1f40b304C9e8ff25D61cD', operatorAddress='0xf11DCB438Ef856C536979B00d971F1A3AFE289cC', amount=1, value=0, gasLimit=134892, gasPrice=49791118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0x8fce9936306e7de7e61cd95e2c59e8467b5c5d104df71ea84a9997e095435f24', registryAddress='0x6dFCB04b7d2aB2069d9ba81aC643556429EB2d55', tokenId='6301', fromAddress='0x787551ae0AB07dE8EB91d1535DBD37f379B0111D', toAddress='0xc797308Ab2d7e643Ceb92465B38cc6C001e5A3DA', operatorAddress='0xc797308Ab2d7e643Ceb92465B38cc6C001e5A3DA', amount=1, value=45000000000000000, gasLimit=316734, gasPrice=49791118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xa3d4eaea7c29aa040f54426b8d88d85dfaa104f0cd09fde594c75cc5476caafd', registryAddress='0x6dFCB04b7d2aB2069d9ba81aC643556429EB2d55', tokenId='4898', fromAddress='0xD49322ADD203C8e04ACDD53B7fF14B5E0AC861D7', toAddress='0xF7ccC7126addDEE2d76EFF0f9f2635857f6E1680', operatorAddress='0xF7ccC7126addDEE2d76EFF0f9f2635857f6E1680', amount=1, value=38000000000000000, gasLimit=294488, gasPrice=49791118272, blockNumber=13281282, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False)
            ]
        )
        assert(result == expected)

    async def test_4(self):
        result = await self.blockProcessor.process_block(13898509)
        expected = ProcessedBlock(
            blockNumber=13898509,
            blockHash='0x0ad4d72b353a6232b69e72bb270457fd4f3c640e40483744d0f0b9997dc2e4e8',
            blockDate=datetime.datetime(2021, 12, 29, 6, 5, 3),
            retrievedTokenTransfers=[
                RetrievedTokenTransfer(transactionHash='0x24de708a8a36d16a68c69d973b3d2126c0d9fd01669335839697f71f7d50d397', registryAddress='0x60E4d786628Fea6478F785A6d7e704777c86a7c6', tokenId='27160', fromAddress='0xC310e760778ECBca4C65B6C559874757A4c4Ece0', toAddress='0x67D5fa7b939899d088A9d548EB9490a379deB912', operatorAddress='0x67D5fa7b939899d088A9d548EB9490a379deB912', amount=1, value=16005000000000000000, gasLimit=314274, gasPrice=82944034756, blockNumber=13898509, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xe00551049632c5ca73ba034b22444bb246dc111a0db3869c591a589dbed4a79b', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', tokenId='87198930750286842836902562062466327909054195361095182156017576659907434774529', fromAddress='0xc0c8d886B92a811E8E41cb6AB5144E44DBBFBFA3', toAddress='0x6904Dfa88D5345dc7E2DE0e1eBa32A6c1E672B93', operatorAddress='0x6768bFdd41927065dba19d3D75e828845c4cdb78', amount=1, value=10000000000000000, gasLimit=294144, gasPrice=79944034756, blockNumber=13898509, tokenType='erc1155single', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x4276409534cc165ef7872a336ed8db65c40428de163406f2b3cf9c4ecdfa9d7b', registryAddress='0x828B78e11BC6A061b8b1AB9CF29C68ED6Abb247B', tokenId='354', fromAddress='0x59CacaD5f405C369E092be30c7B571384fcB0A9d', toAddress='0xa511Bf40cF8A5090a3cc19C6DF38dbCC1DC755A3', operatorAddress='0xa511Bf40cF8A5090a3cc19C6DF38dbCC1DC755A3', amount=1, value=90000000000000000, gasLimit=313653, gasPrice=79444034756, blockNumber=13898509, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x6bb37dcb9a60ed49da56ccfb21dfcae886e81debd3ab94d73497d62744e758d2', registryAddress='0x57f1887a8BF19b14fC0dF6Fd9B2acc9Af147eA85', tokenId='53091478429947851570161017064535674537231673781900674689421707367586767084753', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x283Af0B28c62C092C9727F1Ee09c02CA627EB7F5', operatorAddress='0x04c1f61baF8DE8DA75DB52f09D9d92a1592f46eA', amount=1, value=0, gasLimit=295604, gasPrice=79444034756, blockNumber=13898509, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x6bb37dcb9a60ed49da56ccfb21dfcae886e81debd3ab94d73497d62744e758d2', registryAddress='0x57f1887a8BF19b14fC0dF6Fd9B2acc9Af147eA85', tokenId='53091478429947851570161017064535674537231673781900674689421707367586767084753', fromAddress='0x283Af0B28c62C092C9727F1Ee09c02CA627EB7F5', toAddress='0x04c1f61baF8DE8DA75DB52f09D9d92a1592f46eA', operatorAddress='0x04c1f61baF8DE8DA75DB52f09D9d92a1592f46eA', amount=1, value=1446765707746493, gasLimit=295604, gasPrice=79444034756, blockNumber=13898509, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x3dc806551a0e136e7b3fd45a2c4cad0453b94729646975c848bea37d4d240ff1', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', tokenId='33471077740815336644207333630678705806324114697619059550958109823696621273089', fromAddress='0x49FfF56A43813EBD66a998cc1E8D243Be76E2736', toAddress='0x482793Cb7Ed29aaC067b22bA899D044b9cb0d0B4', operatorAddress='0x1a5079b5AC48c82930Dd8e3FDa7c8b52DA2002d8', amount=1, value=15000000000000000, gasLimit=294206, gasPrice=79444034756, blockNumber=13898509, tokenType='erc1155single', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x6f1e7cd317033576834b26edac15a8554de2e680e3ca2bf089905460e8e5eb12', registryAddress='0x176e0Fe17314DEf59F0F06e976E1b74203be4a55', tokenId='3232', fromAddress='0xD4506C84436a40621DBC1d2DFa8046d80fe9a09b', toAddress='0x294b6439E6c49799F13C6b90E804828fE8384d4F', operatorAddress='0x294b6439E6c49799F13C6b90E804828fE8384d4F', amount=1, value=10000000000000000, gasLimit=259232, gasPrice=79444034756, blockNumber=13898509, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xd7bad8ba0aa35a838b7abe49fe4bda5e57185977346140d4bd13b1bc95568c4b', registryAddress='0xbD275ce24f32d6cE4e9d9519C55ABe9Bc0ed7fCf', tokenId='2717', fromAddress='0xBffe952968A7526fce2b03544Af5E8D5df9c071e', toAddress='0xc69004e5384391D86C002643D84da620B26e89D8', operatorAddress='0xc69004e5384391D86C002643D84da620B26e89D8', amount=1, value=690000000000000000, gasLimit=303168, gasPrice=79444034756, blockNumber=13898509, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xfd6de8afeede32ae5cf28a79b6f68cba295e4a9c1291b6f6302a70b03922c0e5', registryAddress='0x524cAB2ec69124574082676e6F654a18df49A048', tokenId='22196', fromAddress='0x5D33503BF891cdD3410AE975D5e929caF72BfeCb', toAddress='0x017146F8ebD8659672063E0d88dC1085f73fE79B', operatorAddress='0x017146F8ebD8659672063E0d88dC1085f73fE79B', amount=1, value=23000000000000000, gasLimit=235328, gasPrice=79444034756, blockNumber=13898509, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x6d3d879469e8ae00f9b48b980d0cf22ff4c5422ee58d3b11ca9d2f38218f125e', registryAddress='0x5BDf397bB2912859Dbd8011F320a222f79A28d2E', tokenId='1406', fromAddress='0x65c4236EaEB83a96c3B16A6eA71785951FA8709b', toAddress='0x28Fe130724e02956E3253377eC7a127BB32EC481', operatorAddress='0x28Fe130724e02956E3253377eC7a127BB32EC481', amount=1, value=295000000000000000, gasLimit=313921, gasPrice=79444034756, blockNumber=13898509, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xf46f8b6647a7f796260a128ad36ff728a59c8fab5b80538275549cc79e9a8743', registryAddress='0xC36442b4a4522E871399CD717aBDD847Ab11FE88', tokenId='174980', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x2480F754530776cFe59bBf26776345AB370eE36A', operatorAddress='0x2480F754530776cFe59bBf26776345AB370eE36A', amount=1, value=9000000000000000000, gasLimit=603351, gasPrice=79444034756, blockNumber=13898509, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xad3bef8676feb8639015f44e56a683ca19d63313fe22d060af8d09c1f89a6a81', registryAddress='0xB6fB14caa60A6b576860959f12AA2D3A8089caa9', tokenId='1009', fromAddress='0x23d2B5a96528B63dbcFe49F8CEB11Cbe27F6D527', toAddress='0x81c257f559196aE212776c47044dd082858A11DA', operatorAddress='0x81c257f559196aE212776c47044dd082858A11DA', amount=1, value=190000000000000000, gasLimit=259639, gasPrice=79444034756, blockNumber=13898509, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xaf6d8eb8f567e4a8b66039458ae1ad4ccc8d4e07ab8000b81de02b2488902553', registryAddress='0x45DB714f24f5A313569c41683047f1d49e78Ba07', tokenId='5535', fromAddress='0x6536590E019Cf82355366483f90dc56D2cBc00Ba', toAddress='0xe30fCec8AfCCDFbD7c41686131D40a710A0780D1', operatorAddress='0x6536590E019Cf82355366483f90dc56D2cBc00Ba', amount=1, value=0, gasLimit=107898, gasPrice=79444034756, blockNumber=13898509, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0xa1a2bdc9738a39258a6f3dc3a4b34c2dd14b15cd90a3509419d4d07659785d1b', registryAddress='0x6468f4243Faa8C3330bAAa0a7a138E2e5628C6f5', tokenId='2384', fromAddress='0xec2018321913a1AF4834D21790A18a87fDaa643C', toAddress='0x2d442036dACF7D8BE18CE8cec29E64E1918D9Fc5', operatorAddress='0x2d442036dACF7D8BE18CE8cec29E64E1918D9Fc5', amount=1, value=209000000000000000, gasLimit=229361, gasPrice=79444034756, blockNumber=13898509, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False)
            ]
        )
        assert(result == expected)

    async def test_5(self):
        result = await self.blockProcessor.process_block(14471751)
        expected = ProcessedBlock(
            blockNumber=14471751,
            blockHash='0xf66a1f642f94f25278e581342fdbd5ef859f82906605bc0af0392ee22a7d4e02',
            blockDate=datetime.datetime(2022, 3, 28, 1, 31, 2),
            retrievedTokenTransfers=[
                RetrievedTokenTransfer(transactionHash='0x926a4062bd2275ff9203c8d0ea86133a44bd9482fcf0554a0f87f82fd575d879', registryAddress='0xa74a6005f87B0eC07872d802459330f40fF6ae86', tokenId='0', fromAddress='0x429caDA80d5151BEe07478Aa3998d7fF662c934a', toAddress='0x0000000000000000000000000000000000000000', operatorAddress='0xd668A2E001f3385B8BBC5a8682AC3C0D83C19122', amount=1, value=0, gasLimit=70599, gasPrice=25985808182, blockNumber=14471751, tokenType='erc1155single', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0x3dc5e135fc2c16ed8ab3398bb89279aae83a794a12406402d7803930409e1ebb', registryAddress='0xC92090f070bf50eEC26D849c88A68112f4f3D98e', tokenId='6012', fromAddress='0x4A507FCd402A4B9d3a3f028ed09A81363a0022B0', toAddress='0x0e88F593111309e0d0C8D683D94B868516dC18E1', operatorAddress='0x0e88F593111309e0d0C8D683D94B868516dC18E1', amount=1, value=118900000000000000, gasLimit=325459, gasPrice=25485808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x1597ca558e3560ba209468aa68724c57c21735fdca19c4969b7f5eabf6e96d35', registryAddress='0x51CC1078b5972a4371cD6ae2c9b195Fd3B103C10', tokenId='1268', fromAddress='0x978f062F9965eBc786B56F111028b60A1067665b', toAddress='0xA8e6268f2b089B808Aca1aAeF6170BA57e384bF2', operatorAddress='0xA8e6268f2b089B808Aca1aAeF6170BA57e384bF2', amount=1, value=9900000000000000, gasLimit=244517, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xc58b685b521ab0f07893382d9f2bf54a1ca632d1f42643910618ab0a85b1f4fa', registryAddress='0x8CD3cEA52a45f30Ed7c93a63FB2b5C13B453d5A1', tokenId='4237', fromAddress='0x8964EE288e13E8626B114cD4fd27aDD62C71B734', toAddress='0x84Ab19e9e19D1c24D0A6Cd46f2447C2EDc190e21', operatorAddress='0x84Ab19e9e19D1c24D0A6Cd46f2447C2EDc190e21', amount=1, value=90000000000000000, gasLimit=333448, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xac2067d495385872d511636f6fe38b08d7516f039757eb0f7ccf962baa8a1ffc', registryAddress='0x48601815f9924A244Afe3B0c53B5501EF204B0bc', tokenId='10002', fromAddress='0xDF71b59542B5B9753A66fb501E0714fC0eA29a83', toAddress='0x0bA516f6142C1cC8B6A6443bEf748e244FeaC99E', operatorAddress='0xDF71b59542B5B9753A66fb501E0714fC0eA29a83', amount=1, value=0, gasLimit=253612, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=True, isBatch=True, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0xac2067d495385872d511636f6fe38b08d7516f039757eb0f7ccf962baa8a1ffc', registryAddress='0x48601815f9924A244Afe3B0c53B5501EF204B0bc', tokenId='1887', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xDF71b59542B5B9753A66fb501E0714fC0eA29a83', operatorAddress='0xDF71b59542B5B9753A66fb501E0714fC0eA29a83', amount=1, value=0, gasLimit=253612, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=True, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xef58f3cedcc22de0cbf0ae627708676fb62aa2c7e288f93b8765f0c4e04ff28a', registryAddress='0x2744fE5e7776BCA0AF1CDEAF3bA3d1F5cae515d3', tokenId='7457', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x14c1774A8ec095e4Ec0B1958f0f95d5A4BD434B7', operatorAddress='0x14c1774A8ec095e4Ec0B1958f0f95d5A4BD434B7', amount=1, value=70000000000000000, gasLimit=138193, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x19ca388e0f70d89a97f4b8345a6de2293057194cdf6143aefef992b7d8f28870', registryAddress='0x33a237B384b7065C815F7c745D73a0AcF140449c', tokenId='9067', fromAddress='0x68C34671659e1b62E36dDb890bC627d2cF7C8bFc', toAddress='0x62a6cc8f3a30e6A56Af632b0bc8DB8F4a4c76BC9', operatorAddress='0x62a6cc8f3a30e6A56Af632b0bc8DB8F4a4c76BC9', amount=1, value=50000000000000000, gasLimit=280460, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x71b21bf8ca2e7c758422d7c2da6cffd12e963ab4f54e93be930e6e9300570660', registryAddress='0x5F53f9f5DcF76757f7CbF35C2e47164C65b9b5eD', tokenId='20178993405474', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x241ec774AE2cEAd1Ab97dc9113b501c1336a25a9', operatorAddress='0x241ec774AE2cEAd1Ab97dc9113b501c1336a25a9', amount=1, value=0, gasLimit=134870, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xeac4bf1333a2ef084e27abcbd59a7bba82399a015d145324c1de4e0af488a560', registryAddress='0xC1c130f6E93F1809f617B28138eec0F594f8391B', tokenId='2839', fromAddress='0x515e31871de8652c6d980D733f062624B649e738', toAddress='0x512C579153AC6fD961a7d9e7b19281B855AAfbE1', operatorAddress='0x512C579153AC6fD961a7d9e7b19281B855AAfbE1', amount=1, value=3200000000000000, gasLimit=253803, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x0e16db8e4fb4ede406d338f0ef26cdadfb1c483836d2291d924ba5c845a01c5a', registryAddress='0xd1B2c485110f5F48165f801B3235dce75D166012', tokenId='6955', fromAddress='0x90b56Cc91b737CaE9dcfBA398007725472142fD1', toAddress='0x8f2b4c1d2d968F6a8c5F101dE4F8cDd064206A76', operatorAddress='0x8f2b4c1d2d968F6a8c5F101dE4F8cDd064206A76', amount=1, value=2000000000000000, gasLimit=244311, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x195a045471e029469c9f6c64270b92ff88fa4b17c161612f0ec8ca60a82985d3', registryAddress='0x709d30f1f60F03D85A0EF33142eF3259392dC9e1', tokenId='1082', fromAddress='0x890aAc7639725f9dd181Caf7cA261d534BDC3178', toAddress='0x12CCdf3513f8f09f4C0E6Ad7821988a7A8Ac0bE1', operatorAddress='0x12CCdf3513f8f09f4C0E6Ad7821988a7A8Ac0bE1', amount=1, value=230000000000000000, gasLimit=261399, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xa00d3bed037fced031cb9b9b942e9ba7865d8bfb0e716596db8e1036525382a6', registryAddress='0x656a6D3081692a7dA5d8cFF1F8951bD078EC82D5', tokenId='547', fromAddress='0x73bbE892B7a848F51476DD948696e51B2EeFA58b', toAddress='0x6fF75E8E6688dd0E3f4b60869345B7C9230F96F4', operatorAddress='0x6fF75E8E6688dd0E3f4b60869345B7C9230F96F4', amount=1, value=24000000000000000, gasLimit=245318, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x442f11b893a498fe2c781e8e6c603ba599384b654ae33a03eeb1a637354a17ae', registryAddress='0xC7dF86762ba83f2a6197e1Ff9Bb40ae0f696B9E6', tokenId='7538', fromAddress='0x890aAc7639725f9dd181Caf7cA261d534BDC3178', toAddress='0x5719d6BC6CC10371F412A19147ee5B044921EEa3', operatorAddress='0x5719d6BC6CC10371F412A19147ee5B044921EEa3', amount=1, value=200000000000000000, gasLimit=316106, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x120bc12d05f3420da474ae6c4a38e4a26ea9124d3ea949631a4b449208ece753', registryAddress='0x651D4424F34e6e918D8e4D2Da4dF3DEbDAe83D0C', tokenId='4386', fromAddress='0xDe7bbb5487AE9399e78e567AfB73CE84Ac20DBd2', toAddress='0xb862018Ec278b819587CE4D62C39e89f10183308', operatorAddress='0xb862018Ec278b819587CE4D62C39e89f10183308', amount=1, value=59000000000000000, gasLimit=310810, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x766a394b9e5fbb95eb6b0cad3032d9de8d8b066a5d15b536448dcb355ac7d2a0', registryAddress='0xaAF03a65CbD8f01b512Cd8d530a675b3963dE255', tokenId='40406', fromAddress='0xbd6B8D8fA94f7307840252548549b56a33c98054', toAddress='0x44A4C21A53b2a48B45606a4A848BC56A20719B41', operatorAddress='0x44A4C21A53b2a48B45606a4A848BC56A20719B41', amount=1, value=134000000000000000, gasLimit=313237, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x7e2d9da491c020a15ed394899a1344560649ce9b07b7a195c425d7b218551954', registryAddress='0xAcfA101ECE167F1894150e090d9471aeE2dD3041', tokenId='3729', fromAddress='0xB8b6aF171335Ce2E327Afd2ebEf1a2c46cd67B01', toAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', operatorAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', amount=1, value=137880000000000000, gasLimit=963497, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x7e2d9da491c020a15ed394899a1344560649ce9b07b7a195c425d7b218551954', registryAddress='0xAcfA101ECE167F1894150e090d9471aeE2dD3041', tokenId='3698', fromAddress='0x9c8BF4D407cff32eC725eb7D43E106163d182269', toAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', operatorAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', amount=1, value=137880000000000000, gasLimit=963497, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x7e2d9da491c020a15ed394899a1344560649ce9b07b7a195c425d7b218551954', registryAddress='0xAcfA101ECE167F1894150e090d9471aeE2dD3041', tokenId='3534', fromAddress='0x30d82b3cB565Da738383356fd17E9306692Bd5b2', toAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', operatorAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', amount=1, value=137880000000000000, gasLimit=963497, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x7e2d9da491c020a15ed394899a1344560649ce9b07b7a195c425d7b218551954', registryAddress='0xAcfA101ECE167F1894150e090d9471aeE2dD3041', tokenId='2539', fromAddress='0x1a63efB8E8b52e63F700038e17909Cf76AEf5415', toAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', operatorAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', amount=1, value=137880000000000000, gasLimit=963497, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x7e2d9da491c020a15ed394899a1344560649ce9b07b7a195c425d7b218551954', registryAddress='0xAcfA101ECE167F1894150e090d9471aeE2dD3041', tokenId='130', fromAddress='0x40Fa37128A7d54DAB2392ACBC4f43827bc67bBE4', toAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', operatorAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', amount=1, value=137880000000000000, gasLimit=963497, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x7090e201a6f4a475474f7d31d25a59011ee4fa0f6d52dc38600238d876f7794c', registryAddress='0xaAF03a65CbD8f01b512Cd8d530a675b3963dE255', tokenId='40405', fromAddress='0xbd6B8D8fA94f7307840252548549b56a33c98054', toAddress='0x8144b782D73345A54B2Ec867b6562E7bFF0d7E47', operatorAddress='0x8144b782D73345A54B2Ec867b6562E7bFF0d7E47', amount=1, value=134000000000000000, gasLimit=310165, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x9fb39065ff2e0219a4fc7cc0f28451ae9900ff72d20db4c0173ac561897a7cdd', registryAddress='0xc71a726D390Bf02b4Af8920c0820970310D0F367', tokenId='87359', fromAddress='0xE6cd4727a1058E6973e973986D0493F1e7975Ef8', toAddress='0xC924696C737b2c5bA17a8dd4E31b77347c124236', operatorAddress='0xC924696C737b2c5bA17a8dd4E31b77347c124236', amount=1, value=0, gasLimit=296922, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x9fb39065ff2e0219a4fc7cc0f28451ae9900ff72d20db4c0173ac561897a7cdd', registryAddress='0xc71a726D390Bf02b4Af8920c0820970310D0F367', tokenId='87359', fromAddress='0xC924696C737b2c5bA17a8dd4E31b77347c124236', toAddress='0x0000000000000000000000000000000000000000', operatorAddress='0xC924696C737b2c5bA17a8dd4E31b77347c124236', amount=1, value=0, gasLimit=296922, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0x4581a271430743fc533bbde55f98925a9327d368e775bf8a3ecacffa7cd50c21', registryAddress='0xfBfEA4A683d37bF68301f6a9acf7e647BfA8e1A7', tokenId='5773', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x186a41bc015905b3210E353C61194c724fFa2BfD', operatorAddress='0x3d70f643E6eED7Af3bd1Fd501daCd5Ae677818B5', amount=1, value=0, gasLimit=124460, gasPrice=24985808182, blockNumber=14471751, tokenType='erc1155single', isMultiAddress=True, isInterstitial=False, isSwap=True, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x4581a271430743fc533bbde55f98925a9327d368e775bf8a3ecacffa7cd50c21', registryAddress='0x3d70f643E6eED7Af3bd1Fd501daCd5Ae677818B5', tokenId='0', fromAddress='0x186a41bc015905b3210E353C61194c724fFa2BfD', toAddress='0x0000000000000000000000000000000000000000', operatorAddress='0x186a41bc015905b3210E353C61194c724fFa2BfD', amount=1, value=0, gasLimit=124460, gasPrice=24985808182, blockNumber=14471751, tokenType='erc1155single', isMultiAddress=True, isInterstitial=False, isSwap=True, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0xcab4c793e35783f6b01ff63f3b05583173af97f56cd77cc7f55b47a5a412e6cc', registryAddress='0xd65c5D035A35F41f31570887E3ddF8c3289EB920', tokenId='3352', fromAddress='0x821bFeb77Bd9Ea82DbE0019fFa980eEbC72DD54b', toAddress='0x1aecf99471Dbd17f6B606a5d91219Ce6b4d1d0eF', operatorAddress='0x1aecf99471Dbd17f6B606a5d91219Ce6b4d1d0eF', amount=1, value=289990000000000000, gasLimit=283650, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x55c798ce7d12bea039ee8d2998984c6ddfdaae405d2bfda4505ac1e836316dd8', registryAddress='0x495f947276749Ce646f68AC8c248420045cb7b5e', tokenId='62578786287700884576176809772688351294829947109357343180499651957424107028481', fromAddress='0x8a5a567E0249C07a560E9255251F3100111005d6', toAddress='0x4b43df952fA40931C377A5b4C6c76a1e2BCA9082', operatorAddress='0x9E00b6ab3A3a143B3431564670552825ea83E9D8', amount=1, value=80000000000000000, gasLimit=308529, gasPrice=24985808182, blockNumber=14471751, tokenType='erc1155single', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x5b3ce058cc1ce14e527706cb4ce2844c9236da04db5be455ea156ce191da434c', registryAddress='0x19cB5b009BdAD0Dad0404DD860b0beA75465E678', tokenId='5110', fromAddress='0x71e7b94490837CCAF45F9f6C7c20a3e17bBEb7d3', toAddress='0x8a9Eb9993ce3cb71AE9E40536ceaA2BB5DE7aC0f', operatorAddress='0x8a9Eb9993ce3cb71AE9E40536ceaA2BB5DE7aC0f', amount=1, value=125000000000000000, gasLimit=247470, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xab79edd7fb5abe1b052218fa631e59916d2a3a9b050fa14ab9152b32b6ea3df0', registryAddress='0x8ee9A60cB5C0e7DB414031856Cb9e0f1F05988D1', tokenId='1559', fromAddress='0x8Df01Af298eFcb47D7Be2ac7D8A8C2f645cf7888', toAddress='0x0000000000000000000000000000000000000000', operatorAddress='0x8Df01Af298eFcb47D7Be2ac7D8A8C2f645cf7888', amount=1, value=0, gasLimit=313046, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=True, isInterstitial=False, isSwap=True, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0xab79edd7fb5abe1b052218fa631e59916d2a3a9b050fa14ab9152b32b6ea3df0', registryAddress='0x685686268be8752221cA696F8d07531a0E2BD097', tokenId='2635', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x8Df01Af298eFcb47D7Be2ac7D8A8C2f645cf7888', operatorAddress='0x8Df01Af298eFcb47D7Be2ac7D8A8C2f645cf7888', amount=1, value=0, gasLimit=313046, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=True, isInterstitial=False, isSwap=True, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xafd0535c4fe269b57cdcd4489eb11f05ff42dce04190b3e65f659ab9f05b71ee', registryAddress='0x57f1887a8BF19b14fC0dF6Fd9B2acc9Af147eA85', tokenId='78102327257348450385369200690909064778782768687076101371929764792747181439823', fromAddress='0x393E7176be67D8FaBA18B2c1C52eb827AA90a824', toAddress='0x0000000000000000000000000000000000000000', operatorAddress='0x92a2eAc2d5d442e489597cdBFEf75514fB97b4c0', amount=1, value=0, gasLimit=245377, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xafd0535c4fe269b57cdcd4489eb11f05ff42dce04190b3e65f659ab9f05b71ee', registryAddress='0x57f1887a8BF19b14fC0dF6Fd9B2acc9Af147eA85', tokenId='78102327257348450385369200690909064778782768687076101371929764792747181439823', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x283Af0B28c62C092C9727F1Ee09c02CA627EB7F5', operatorAddress='0x92a2eAc2d5d442e489597cdBFEf75514fB97b4c0', amount=1, value=0, gasLimit=245377, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xafd0535c4fe269b57cdcd4489eb11f05ff42dce04190b3e65f659ab9f05b71ee', registryAddress='0x57f1887a8BF19b14fC0dF6Fd9B2acc9Af147eA85', tokenId='78102327257348450385369200690909064778782768687076101371929764792747181439823', fromAddress='0x283Af0B28c62C092C9727F1Ee09c02CA627EB7F5', toAddress='0x92a2eAc2d5d442e489597cdBFEf75514fB97b4c0', operatorAddress='0x92a2eAc2d5d442e489597cdBFEf75514fB97b4c0', amount=1, value=5020756571078947, gasLimit=245377, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x111606e0213a0d609dab1667663c5726f11c3651198d8f05f251a873a2019011', registryAddress='0xf880B2a16f257D0b9b8ab64351A07a4137527C82', tokenId='5110', fromAddress='0xF6EDbb768d28c9479609dBF2cbc82eeE9df440b3', toAddress='0x685A3c495b48B7234fF0A77E6D40fD7419e5423e', operatorAddress='0x685A3c495b48B7234fF0A77E6D40fD7419e5423e', amount=1, value=12000000000000000, gasLimit=280438, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x717ebd38689141614334c6c1cf378a3239137e7b3774fe8f97f778e910f23c65', registryAddress='0xB89fE5a72B3A71e585f468C3fF2d1f67Df13B256', tokenId='658', fromAddress='0xE56e4ece94C649425d26d9B4F87c58e33A944390', toAddress='0xFF4C7b106b7Da3f1f69a1D35bCB2840A66857D6e', operatorAddress='0xE56e4ece94C649425d26d9B4F87c58e33A944390', amount=1, value=0, gasLimit=202956, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0x717ebd38689141614334c6c1cf378a3239137e7b3774fe8f97f778e910f23c65', registryAddress='0xB89fE5a72B3A71e585f468C3fF2d1f67Df13B256', tokenId='658', fromAddress='0xFF4C7b106b7Da3f1f69a1D35bCB2840A66857D6e', toAddress='0x0000000000000000000000000000000000000000', operatorAddress='0xE56e4ece94C649425d26d9B4F87c58e33A944390', amount=1, value=0, gasLimit=202956, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x033522e2458169357b42c8ea413c21196097354c8e715b14703ca2299893ec96', registryAddress='0xd7BE914cB2B5EDEdc23b6e68e0B9bF364DC96F57', tokenId='844', fromAddress='0x1E5086D60c86783cF5981fD2bB49341cd60b2CB3', toAddress='0xb3fC98165d106E0e4eCe962893deCb1548bB3183', operatorAddress='0xb3fC98165d106E0e4eCe962893deCb1548bB3183', amount=1, value=20000000000000000, gasLimit=321658, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x00662357687e52c42797371187559a6cb8977394356f2340fbde11f7611ac71c', registryAddress='0xaAF03a65CbD8f01b512Cd8d530a675b3963dE255', tokenId='45611', fromAddress='0xb779305CF5469b53b593D901B02B6603983Ad6A5', toAddress='0xd3F0862E4AcEf9A0c2D7FC4EAc9AB02c80D7b16c', operatorAddress='0xd3F0862E4AcEf9A0c2D7FC4EAc9AB02c80D7b16c', amount=1, value=131666666666666672, gasLimit=570864, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x00662357687e52c42797371187559a6cb8977394356f2340fbde11f7611ac71c', registryAddress='0xaAF03a65CbD8f01b512Cd8d530a675b3963dE255', tokenId='33721', fromAddress='0x726b5C43f0315e84215b9efb03DE6e87546e54c3', toAddress='0xd3F0862E4AcEf9A0c2D7FC4EAc9AB02c80D7b16c', operatorAddress='0xd3F0862E4AcEf9A0c2D7FC4EAc9AB02c80D7b16c', amount=1, value=131666666666666672, gasLimit=570864, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x00662357687e52c42797371187559a6cb8977394356f2340fbde11f7611ac71c', registryAddress='0xaAF03a65CbD8f01b512Cd8d530a675b3963dE255', tokenId='40328', fromAddress='0x33a107dF65B0E7652E019f0e3A5Cae235e56E972', toAddress='0xd3F0862E4AcEf9A0c2D7FC4EAc9AB02c80D7b16c', operatorAddress='0xd3F0862E4AcEf9A0c2D7FC4EAc9AB02c80D7b16c', amount=1, value=131666666666666672, gasLimit=570864, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xdc7116a5222044bdfcbad0c6091e4721e4ff0037e12c92205baba971c07305a4', registryAddress='0x57f1887a8BF19b14fC0dF6Fd9B2acc9Af147eA85', tokenId='96956256455254401493129371003084312593830482736916520985321412892578900597650', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x283Af0B28c62C092C9727F1Ee09c02CA627EB7F5', operatorAddress='0x7f8e92e97E1a8a960E60B240309Cd4305a973d83', amount=1, value=0, gasLimit=302785, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xdc7116a5222044bdfcbad0c6091e4721e4ff0037e12c92205baba971c07305a4', registryAddress='0x57f1887a8BF19b14fC0dF6Fd9B2acc9Af147eA85', tokenId='96956256455254401493129371003084312593830482736916520985321412892578900597650', fromAddress='0x283Af0B28c62C092C9727F1Ee09c02CA627EB7F5', toAddress='0x7f8e92e97E1a8a960E60B240309Cd4305a973d83', operatorAddress='0x7f8e92e97E1a8a960E60B240309Cd4305a973d83', amount=1, value=5020756571078947, gasLimit=302785, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x298067f2f3db3b06e1235b8becfc99925346f4fe1255ac905ae8faa39e7ff965', registryAddress='0x9b62238F47358aF1Ab61c8b55bD2aB50E95ae691', tokenId='2089', fromAddress='0x1A77C793881C811a89c8bf54ffF6BC733b921f97', toAddress='0xA30a503bFFBf03a4041d9152aae67F8eAD7a02e8', operatorAddress='0xA30a503bFFBf03a4041d9152aae67F8eAD7a02e8', amount=1, value=16000000000000000, gasLimit=261472, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xa1306e57b384522d7ba658ea294e69061f1bacabe448ad4b37912d1d4a4d1b2b', registryAddress='0xaAF03a65CbD8f01b512Cd8d530a675b3963dE255', tokenId='44648', fromAddress='0xbd6B8D8fA94f7307840252548549b56a33c98054', toAddress='0xB4A3e793596136EE7d04588f4aF014D19d79CE8b', operatorAddress='0xB4A3e793596136EE7d04588f4aF014D19d79CE8b', amount=1, value=135000000000000000, gasLimit=310203, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x150017f58d389028ce4afaae63b9b4f8842aaddf75c3fa7711f75fc30c3dc19d', registryAddress='0x87E738a3d5E5345d6212D8982205A564289e6324', tokenId='16496', fromAddress='0x64615160576999fF34c15bBD1F25d606b7A86bE5', toAddress='0xd311bDACB151b72BddFEE9cBdC414Af22a5E38dc', operatorAddress='0x64615160576999fF34c15bBD1F25d606b7A86bE5', amount=1, value=0, gasLimit=356015, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0x150017f58d389028ce4afaae63b9b4f8842aaddf75c3fa7711f75fc30c3dc19d', registryAddress='0x87E738a3d5E5345d6212D8982205A564289e6324', tokenId='16496', fromAddress='0xd311bDACB151b72BddFEE9cBdC414Af22a5E38dc', toAddress='0x5cfEf6B6777aD143e6Edc122632984C87dC6FB40', operatorAddress='0x64615160576999fF34c15bBD1F25d606b7A86bE5', amount=1, value=0, gasLimit=356015, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x150017f58d389028ce4afaae63b9b4f8842aaddf75c3fa7711f75fc30c3dc19d', registryAddress='0x87E738a3d5E5345d6212D8982205A564289e6324', tokenId='16496', fromAddress='0x5cfEf6B6777aD143e6Edc122632984C87dC6FB40', toAddress='0x0000000000000000000000000000000000000000', operatorAddress='0x64615160576999fF34c15bBD1F25d606b7A86bE5', amount=1, value=0, gasLimit=356015, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xd3851c63812b77056bddf6559bf505dace4d28e55f71117618b4c1e2bc44fced', registryAddress='0x57f1887a8BF19b14fC0dF6Fd9B2acc9Af147eA85', tokenId='64126451017858687767628212462418387580469276583870713284584367258696202074301', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x283Af0B28c62C092C9727F1Ee09c02CA627EB7F5', operatorAddress='0x23a35DCc4dbEeA3CbAC3Ae1db37Cb87c625b8F54', amount=1, value=0, gasLimit=286645, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xd3851c63812b77056bddf6559bf505dace4d28e55f71117618b4c1e2bc44fced', registryAddress='0x57f1887a8BF19b14fC0dF6Fd9B2acc9Af147eA85', tokenId='64126451017858687767628212462418387580469276583870713284584367258696202074301', fromAddress='0x283Af0B28c62C092C9727F1Ee09c02CA627EB7F5', toAddress='0x23a35DCc4dbEeA3CbAC3Ae1db37Cb87c625b8F54', operatorAddress='0x23a35DCc4dbEeA3CbAC3Ae1db37Cb87c625b8F54', amount=1, value=3347171047385964, gasLimit=286645, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x9fed491ea78a9624e85dc93f50982ca63f78498c966bcb25f40ef62b97ada426', registryAddress='0xE24e4d4535F504D6D7957356534E23b4e787289F', tokenId='2551', fromAddress='0x824Fc77A71f8c81DBF8Ff3cB82293632B336F513', toAddress='0xFa45291c4a6F64d9E4497805c5B73e2Be71342Fc', operatorAddress='0xFa45291c4a6F64d9E4497805c5B73e2Be71342Fc', amount=1, value=55000000000000000, gasLimit=260847, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x18fd3ddcbaf49534084b182b2e4202cd36898cf4bbfe56e90ca31693386a6e61', registryAddress='0xd7BE914cB2B5EDEdc23b6e68e0B9bF364DC96F57', tokenId='969', fromAddress='0x60F3e12c8c80564AD8712F80efdB5aB171662BCE', toAddress='0x13FEFfBFEE2dA6db7A5CA20022A786B9c5417D64', operatorAddress='0x13FEFfBFEE2dA6db7A5CA20022A786B9c5417D64', amount=1, value=9800000000000000, gasLimit=318087, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x21a218a3fe6538551b2cc6870813ee1a8e9b92eb80c9d5e8c07768942a89cb0f', registryAddress='0xE6e8941f9B5CfA6f281f64DF76848920BE7911B3', tokenId='5010', fromAddress='0x53e3FDfcC718BFDd8937a1251C3c04aC95c5Ec68', toAddress='0xeaF14E168446fb6d208Ad2B0d8C111fCB717a125', operatorAddress='0xeaF14E168446fb6d208Ad2B0d8C111fCB717a125', amount=1, value=50000000000000000, gasLimit=314894, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x88affc90581254ca2ceb04cefac281c4e704d457999c6a7135072a92a7befc8b', registryAddress='0x87084477F7172dfC303A31efd33e9cA6eA8CABCE', tokenId='0', fromAddress='0xDb16426B5a091b1eAa16F9a2BB6BD27DBf4244f5', toAddress='0xCB754bE09C64E2e1010aD3BB648C776AB53Ee67b', operatorAddress='0x70C8Ba6125f96aF883862bb035D36B7970bA8ea2', amount=4, value=77200000000000000, gasLimit=692793, gasPrice=24985808182, blockNumber=14471751, tokenType='erc1155single', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xcd8ee3caf2045a8fb412c859c55cbcf7462c04bf10e9cc36038f0d58b1a2e549', registryAddress='0x3e55D389D352f4905961a6B32cA53B2F229Fed73', tokenId='3242', fromAddress='0xf219e5301f235D8A65250859e3Fe48175C15FB8a', toAddress='0xeff3abC400D5a45D4280F89bD2c8142CdB269dB2', operatorAddress='0xeff3abC400D5a45D4280F89bD2c8142CdB269dB2', amount=1, value=50000000000000000, gasLimit=257438, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xdf35367c56da2ffd3fd9ab79f7f74d19a8efb3a5aa7b7771297fe4ebf3cabe19', registryAddress='0x8B6d881Cb985c2c49e893A522735852839C58737', tokenId='2642', fromAddress='0x05f3E0195F0f12F652F7aC19fDc837f66C6bD4D2', toAddress='0xF9b421ce4DdE27aC57Bb94EF562566956DC1c97E', operatorAddress='0xF9b421ce4DdE27aC57Bb94EF562566956DC1c97E', amount=1, value=93000000000000000, gasLimit=283073, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xf6d889a1985cf1ce0ee0fc54c71f7fc982bc3ec26990ac2bf3ddede00dce6f9f', registryAddress='0x7eCb204feD7e386386CAb46a1fcB823ec5067aD5', tokenId='8080', fromAddress='0x5B011C6170E84B66c479358B17f77029Eca6e51E', toAddress='0x5315cD82Bd992b5307c8c2BEBa1a83c8BbF85De4', operatorAddress='0x5315cD82Bd992b5307c8c2BEBa1a83c8BbF85De4', amount=1, value=889000000000000000, gasLimit=276295, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xd5e7ee74b39778153b44e49bc94701899d1149f902cd82b72f8c7d148cb63385', registryAddress='0x55f3bc084Da207B7347538B74cC388DEEB3AB448', tokenId='10558', fromAddress='0x573D14afFD39Ed045Bd3E847111004c4DbAbaCdC', toAddress='0xB917305baE6368EF8fc0658D6DA86b22E1d16C5A', operatorAddress='0xB917305baE6368EF8fc0658D6DA86b22E1d16C5A', amount=1, value=97000000000000000, gasLimit=310954, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x7140c0812d72f4c638d7df778b9f19cdd04c03369295a8bf36eef5b3a383fbbe', registryAddress='0x06245Be6757526641b7Cf1e05CdBC1176184dfCb', tokenId='7979', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xa0e8b97f25499841B4a5A8536a0fAe02E734FBe9', operatorAddress='0xa0e8b97f25499841B4a5A8536a0fAe02E734FBe9', amount=1, value=0, gasLimit=91501, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x7140c0812d72f4c638d7df778b9f19cdd04c03369295a8bf36eef5b3a383fbbe', registryAddress='0x06245Be6757526641b7Cf1e05CdBC1176184dfCb', tokenId='7980', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xa0e8b97f25499841B4a5A8536a0fAe02E734FBe9', operatorAddress='0xa0e8b97f25499841B4a5A8536a0fAe02E734FBe9', amount=1, value=0, gasLimit=91501, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x7140c0812d72f4c638d7df778b9f19cdd04c03369295a8bf36eef5b3a383fbbe', registryAddress='0x06245Be6757526641b7Cf1e05CdBC1176184dfCb', tokenId='7981', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xa0e8b97f25499841B4a5A8536a0fAe02E734FBe9', operatorAddress='0xa0e8b97f25499841B4a5A8536a0fAe02E734FBe9', amount=1, value=0, gasLimit=91501, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x7140c0812d72f4c638d7df778b9f19cdd04c03369295a8bf36eef5b3a383fbbe', registryAddress='0x06245Be6757526641b7Cf1e05CdBC1176184dfCb', tokenId='7982', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xa0e8b97f25499841B4a5A8536a0fAe02E734FBe9', operatorAddress='0xa0e8b97f25499841B4a5A8536a0fAe02E734FBe9', amount=1, value=0, gasLimit=91501, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x7140c0812d72f4c638d7df778b9f19cdd04c03369295a8bf36eef5b3a383fbbe', registryAddress='0x06245Be6757526641b7Cf1e05CdBC1176184dfCb', tokenId='7983', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xa0e8b97f25499841B4a5A8536a0fAe02E734FBe9', operatorAddress='0xa0e8b97f25499841B4a5A8536a0fAe02E734FBe9', amount=1, value=0, gasLimit=91501, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x7140c0812d72f4c638d7df778b9f19cdd04c03369295a8bf36eef5b3a383fbbe', registryAddress='0x06245Be6757526641b7Cf1e05CdBC1176184dfCb', tokenId='7984', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xa0e8b97f25499841B4a5A8536a0fAe02E734FBe9', operatorAddress='0xa0e8b97f25499841B4a5A8536a0fAe02E734FBe9', amount=1, value=0, gasLimit=91501, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x7140c0812d72f4c638d7df778b9f19cdd04c03369295a8bf36eef5b3a383fbbe', registryAddress='0x06245Be6757526641b7Cf1e05CdBC1176184dfCb', tokenId='7985', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xa0e8b97f25499841B4a5A8536a0fAe02E734FBe9', operatorAddress='0xa0e8b97f25499841B4a5A8536a0fAe02E734FBe9', amount=1, value=0, gasLimit=91501, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x7140c0812d72f4c638d7df778b9f19cdd04c03369295a8bf36eef5b3a383fbbe', registryAddress='0x06245Be6757526641b7Cf1e05CdBC1176184dfCb', tokenId='7986', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xa0e8b97f25499841B4a5A8536a0fAe02E734FBe9', operatorAddress='0xa0e8b97f25499841B4a5A8536a0fAe02E734FBe9', amount=1, value=0, gasLimit=91501, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x7140c0812d72f4c638d7df778b9f19cdd04c03369295a8bf36eef5b3a383fbbe', registryAddress='0x06245Be6757526641b7Cf1e05CdBC1176184dfCb', tokenId='7987', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xa0e8b97f25499841B4a5A8536a0fAe02E734FBe9', operatorAddress='0xa0e8b97f25499841B4a5A8536a0fAe02E734FBe9', amount=1, value=0, gasLimit=91501, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xac17e188ed970d71007352aa8593b664a9755d33b53406bcaaa65fc844c74ef2', registryAddress='0x87E738a3d5E5345d6212D8982205A564289e6324', tokenId='16827', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x3399614E33d68eD744ca5828C90Ca4E4ccb657b8', operatorAddress='0x3399614E33d68eD744ca5828C90Ca4E4ccb657b8', amount=1, value=0, gasLimit=155596, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x81066f0a326b096f759c803f7d8dc41c725e715229fbdaa5acd370e5e227304f', registryAddress='0x87E738a3d5E5345d6212D8982205A564289e6324', tokenId='16828', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x3399614E33d68eD744ca5828C90Ca4E4ccb657b8', operatorAddress='0x3399614E33d68eD744ca5828C90Ca4E4ccb657b8', amount=1, value=0, gasLimit=155596, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x82e80765cf58b018a2bb29392a57a214d68179453eb0da558775d306c68087a7', registryAddress='0xf9d53E156fE880889E777392585FEb46D8D840f6', tokenId='2995', fromAddress='0x6B05D9AfF3E050dFCb98A9cB99d746920AD6a00f', toAddress='0x78A8A1deCFd67902E04ba32b3dbcd6bf5244eaf4', operatorAddress='0x6B05D9AfF3E050dFCb98A9cB99d746920AD6a00f', amount=1, value=0, gasLimit=134983, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0x23b44e6260e9bbfb8283911abd8718f4f4fcbaa5ed2deeb70c87a3e09ba589f1', registryAddress='0xC36442b4a4522E871399CD717aBDD847Ab11FE88', tokenId='213471', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x4160C656eFa088791873025B87699E9e04B45480', operatorAddress='0x4160C656eFa088791873025B87699E9e04B45480', amount=1, value=84519724308726432, gasLimit=651220, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0x80600d1e16c9b653f0f95883e81445b7dfd4aac1422b2044aa8a27cde4af2221', registryAddress='0xA6310c39FAA5E21cC29c4B283C6CD4eF51c00D21', tokenId='0', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0xb803cc308727de87E82E90D60C6fae3c46d2012E', operatorAddress='0xb803cc308727de87E82E90D60C6fae3c46d2012E', amount=2, value=0, gasLimit=137621, gasPrice=24985808182, blockNumber=14471751, tokenType='erc1155single', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
                RetrievedTokenTransfer(transactionHash='0xda1655e9888030cbabeaff787b7373a4ac514a07887db3b203a430a08eac6e81', registryAddress='0x5Af0D9827E0c53E4799BB226655A1de152A425a5', tokenId='7762', fromAddress='0x49C233D25768E462F0474390F653BAF40DD592b2', toAddress='0x227c7DF69D3ed1ae7574A1a7685fDEd90292EB48', operatorAddress='0x49C233D25768E462F0474390F653BAF40DD592b2', amount=1, value=0, gasLimit=522957, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
                RetrievedTokenTransfer(transactionHash='0x2d1f99ae8a9a4c1b8a84164e6105e7ab90a9779913453c81406c67be79d602d5', registryAddress='0x0841098535ABB3fADc4DC5389EBc3B434D678AcC', tokenId='486', fromAddress='0xEa92A3bbBC1EFc14C75a0880d29D435192ab946E', toAddress='0xDA9c6682b950EF1c8074EB7706793B80aec20b41', operatorAddress='0xDA9c6682b950EF1c8074EB7706793B80aec20b41', amount=1, value=10000000000000000, gasLimit=278711, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False)
            ]
        )
        assert(result == expected)
    
    
class TestProcessTransaction(BlockProcessorTestCase):

    async def _process_block_transaction(self, blockNumber: int, transactionHash: str) -> List[RetrievedTokenTransfer]:
        transaction = await _get_transaction(ethClient=self.ethClient, blockNumber=blockNumber, transactionHash=transactionHash)
        retrievedEvents = await get_transaction_retrieved_events(blockProcessor=self.blockProcessor, blockNumber=blockNumber, transactionHash=transactionHash)
        retrievedTokenTransfers = await self.blockProcessor.process_transaction(transaction=transaction, retrievedEvents=retrievedEvents)
        return retrievedTokenTransfers

    async def test_selling_multiple(self):
        result = await self._process_block_transaction(blockNumber=13281280, transactionHash='0xf1f0758d54474efb810e470592349703adc758c5037e56ae1bd6a789e9a079ef')
        expected = [
            RetrievedTokenTransfer(transactionHash='0xf1f0758d54474efb810e470592349703adc758c5037e56ae1bd6a789e9a079ef', registryAddress='0x2216d47494E516d8206B70FCa8585820eD3C4946', tokenId='14364', fromAddress='0xffF8f66e26ac1A75F2b5Da49c247f3Ec0D0EA5ba', toAddress='0x0000000000000000000000000000000000080085', operatorAddress='0xffF8f66e26ac1A75F2b5Da49c247f3Ec0D0EA5ba', amount=1, value=0, gasLimit=449751, gasPrice=48786337690, blockNumber=13281280, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=True),
            RetrievedTokenTransfer(transactionHash='0xf1f0758d54474efb810e470592349703adc758c5037e56ae1bd6a789e9a079ef', registryAddress='0x2216d47494E516d8206B70FCa8585820eD3C4946', tokenId='10626', fromAddress='0xffF8f66e26ac1A75F2b5Da49c247f3Ec0D0EA5ba', toAddress='0x0000000000000000000000000000000000080085', operatorAddress='0xffF8f66e26ac1A75F2b5Da49c247f3Ec0D0EA5ba', amount=1, value=0, gasLimit=449751, gasPrice=48786337690, blockNumber=13281280, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=True),
            RetrievedTokenTransfer(transactionHash='0xf1f0758d54474efb810e470592349703adc758c5037e56ae1bd6a789e9a079ef', registryAddress='0x2216d47494E516d8206B70FCa8585820eD3C4946', tokenId='10627', fromAddress='0xffF8f66e26ac1A75F2b5Da49c247f3Ec0D0EA5ba', toAddress='0x0000000000000000000000000000000000080085', operatorAddress='0xffF8f66e26ac1A75F2b5Da49c247f3Ec0D0EA5ba', amount=1, value=0, gasLimit=449751, gasPrice=48786337690, blockNumber=13281280, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=True),
        ]
        self.assertEqual(result, expected)

    async def test_buying_multiple_tokens_from_same_collection(self):
        # Account buys multiple NFTs (of the same collection) from another account
        # https://etherscan.io/tx/0x7e2d9da491c020a15ed394899a1344560649ce9b07b7a195c425d7b218551954  started by 027a
        # 5 transfers each with (0.684/5)eth value with 0x27a as the receiver for each and multiple senders
        result = await self._process_block_transaction(blockNumber=14471751, transactionHash='0x7e2d9da491c020a15ed394899a1344560649ce9b07b7a195c425d7b218551954')
        expected = [
            RetrievedTokenTransfer(transactionHash='0x7e2d9da491c020a15ed394899a1344560649ce9b07b7a195c425d7b218551954', registryAddress='0xAcfA101ECE167F1894150e090d9471aeE2dD3041', tokenId='3729', fromAddress='0xB8b6aF171335Ce2E327Afd2ebEf1a2c46cd67B01', toAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', operatorAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', amount=1, value=137880000000000000, gasLimit=963497, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x7e2d9da491c020a15ed394899a1344560649ce9b07b7a195c425d7b218551954', registryAddress='0xAcfA101ECE167F1894150e090d9471aeE2dD3041', tokenId='3698', fromAddress='0x9c8BF4D407cff32eC725eb7D43E106163d182269', toAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', operatorAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', amount=1, value=137880000000000000, gasLimit=963497, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x7e2d9da491c020a15ed394899a1344560649ce9b07b7a195c425d7b218551954', registryAddress='0xAcfA101ECE167F1894150e090d9471aeE2dD3041', tokenId='3534', fromAddress='0x30d82b3cB565Da738383356fd17E9306692Bd5b2', toAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', operatorAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', amount=1, value=137880000000000000, gasLimit=963497, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x7e2d9da491c020a15ed394899a1344560649ce9b07b7a195c425d7b218551954', registryAddress='0xAcfA101ECE167F1894150e090d9471aeE2dD3041', tokenId='2539', fromAddress='0x1a63efB8E8b52e63F700038e17909Cf76AEf5415', toAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', operatorAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', amount=1, value=137880000000000000, gasLimit=963497, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x7e2d9da491c020a15ed394899a1344560649ce9b07b7a195c425d7b218551954', registryAddress='0xAcfA101ECE167F1894150e090d9471aeE2dD3041', tokenId='130', fromAddress='0x40Fa37128A7d54DAB2392ACBC4f43827bc67bBE4', toAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', operatorAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', amount=1, value=137880000000000000, gasLimit=963497, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
        ]
        self.assertEqual(result, expected)

    async def test_buying_multiple_with_interstitial(self):
        # Account buys multiple NFTs (of the same collection) from multiple accounts in one transaction started by 0x4ea
        # https://etherscan.io/tx/0x8b52d281485f735dbe910f76d92dd317549790f39778e9461c81f489ebd3763c
        # 5 transfers each with (1.338/5)eth value with 0x4ea as the receiver for each and multiple senders
        result = await self._process_block_transaction(blockNumber=14850684, transactionHash='0x8b52d281485f735dbe910f76d92dd317549790f39778e9461c81f489ebd3763c')
        expected = [
            RetrievedTokenTransfer(transactionHash='0x8b52d281485f735dbe910f76d92dd317549790f39778e9461c81f489ebd3763c', registryAddress='0x64b6b4142d4D78E49D53430C1d3939F2317f9085', tokenId='4774', fromAddress='0xc955Ce75796eF64eB1F09e9eff4481c8968C9346', toAddress='0x4eA1577b6c155A588A6c18767E6FAaEF51091aC2', operatorAddress='0x4eA1577b6c155A588A6c18767E6FAaEF51091aC2', amount=1, value=446000000000000000, gasLimit=579311, gasPrice=53578026373, blockNumber=14850684, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x8b52d281485f735dbe910f76d92dd317549790f39778e9461c81f489ebd3763c', registryAddress='0x64b6b4142d4D78E49D53430C1d3939F2317f9085', tokenId='5660', fromAddress='0x38a48DDF98D3d6AF7fD46a692265D72515534525', toAddress='0xF97E9727d8E7DB7AA8f006D1742d107cF9411412', operatorAddress='0x4eA1577b6c155A588A6c18767E6FAaEF51091aC2', amount=1, value=0, gasLimit=579311, gasPrice=53578026373, blockNumber=14850684, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x8b52d281485f735dbe910f76d92dd317549790f39778e9461c81f489ebd3763c', registryAddress='0x64b6b4142d4D78E49D53430C1d3939F2317f9085', tokenId='5660', fromAddress='0xF97E9727d8E7DB7AA8f006D1742d107cF9411412', toAddress='0x4eA1577b6c155A588A6c18767E6FAaEF51091aC2', operatorAddress='0x4eA1577b6c155A588A6c18767E6FAaEF51091aC2', amount=1, value=446000000000000000, gasLimit=579311, gasPrice=53578026373, blockNumber=14850684, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x8b52d281485f735dbe910f76d92dd317549790f39778e9461c81f489ebd3763c', registryAddress='0x64b6b4142d4D78E49D53430C1d3939F2317f9085', tokenId='5729', fromAddress='0x172458fF1b115ba5C2076465977Baf6152C5Ac72', toAddress='0xF97E9727d8E7DB7AA8f006D1742d107cF9411412', operatorAddress='0x4eA1577b6c155A588A6c18767E6FAaEF51091aC2', amount=1, value=0, gasLimit=579311, gasPrice=53578026373, blockNumber=14850684, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x8b52d281485f735dbe910f76d92dd317549790f39778e9461c81f489ebd3763c', registryAddress='0x64b6b4142d4D78E49D53430C1d3939F2317f9085', tokenId='5729', fromAddress='0xF97E9727d8E7DB7AA8f006D1742d107cF9411412', toAddress='0x4eA1577b6c155A588A6c18767E6FAaEF51091aC2', operatorAddress='0x4eA1577b6c155A588A6c18767E6FAaEF51091aC2', amount=1, value=446000000000000000, gasLimit=579311, gasPrice=53578026373, blockNumber=14850684, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
        ]
        self.assertEqual(result, expected)

    async def test_buying_multiple_erc721_tokens_from_same_collection(self):
        # https://etherscan.io/tx/0x06dba7d73e25ca8b918d50fb9f9f53d8afa5318e2fdcc499c432cb7a130ea4e6 started by 0x1809
        # 3 transfers with value(0.0115/3)
        result = await self._process_block_transaction(blockNumber=14804639, transactionHash='0x06dba7d73e25ca8b918d50fb9f9f53d8afa5318e2fdcc499c432cb7a130ea4e6')
        expected = [
            RetrievedTokenTransfer(transactionHash='0x06dba7d73e25ca8b918d50fb9f9f53d8afa5318e2fdcc499c432cb7a130ea4e6', registryAddress='0xC2d29135b7252dd4d18bA9ca375b10FF61c860A8', tokenId='7711', fromAddress='0xAe37a30979B78921c418085E121B3f6BccFB35ae', toAddress='0x18090cDA49B21dEAffC21b4F886aed3eB787d032', operatorAddress='0x18090cDA49B21dEAffC21b4F886aed3eB787d032', amount=1, value=3833333333333333, gasLimit=586512, gasPrice=21361342786, blockNumber=14804639, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x06dba7d73e25ca8b918d50fb9f9f53d8afa5318e2fdcc499c432cb7a130ea4e6', registryAddress='0xC2d29135b7252dd4d18bA9ca375b10FF61c860A8', tokenId='3425', fromAddress='0x77E27652B7441C5880927423f22Cf9e69c298f5e', toAddress='0x18090cDA49B21dEAffC21b4F886aed3eB787d032', operatorAddress='0x18090cDA49B21dEAffC21b4F886aed3eB787d032', amount=1, value=3833333333333333, gasLimit=586512, gasPrice=21361342786, blockNumber=14804639, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x06dba7d73e25ca8b918d50fb9f9f53d8afa5318e2fdcc499c432cb7a130ea4e6', registryAddress='0xC2d29135b7252dd4d18bA9ca375b10FF61c860A8', tokenId='133', fromAddress='0x77E27652B7441C5880927423f22Cf9e69c298f5e', toAddress='0x18090cDA49B21dEAffC21b4F886aed3eB787d032', operatorAddress='0x18090cDA49B21dEAffC21b4F886aed3eB787d032', amount=1, value=3833333333333333, gasLimit=586512, gasPrice=21361342786, blockNumber=14804639, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
        ]
        self.assertEqual(result, expected)

    async def test_multiple_collections_in_a_single_transaction(self):
        # Account buys multiple NFTs (of the different collections) from another account
        # https://etherscan.io/tx/0xd40859bfc1ce80da0e81b8f82b15db1222f6937d108daca7f259e3dd162c5170 started by 0x9e56
        # Transfer of 2 SANDBOX tokens: value=0 from 0xf91 to 0x9e5 isMultiAddressTransfer=true
        # Transfer of 5 SANDBOX ASSET tokens: value=0 from 0xf91 to 0x9e5 isMultiAddressTransfer=true
        result = await self._process_block_transaction(blockNumber=11003194, transactionHash='0xd40859bfc1ce80da0e81b8f82b15db1222f6937d108daca7f259e3dd162c5170')
        expected = [
            RetrievedTokenTransfer(transactionHash='0xd40859bfc1ce80da0e81b8f82b15db1222f6937d108daca7f259e3dd162c5170', registryAddress='0x50f5474724e0Ee42D9a4e711ccFB275809Fd6d4a', tokenId='100834', fromAddress='0xF91B20739309040c93eCD70ae8a7dAC4728d2Fbc', toAddress='0x9e56C62aa6185A8b7F30DAf5be0EA05718DB6997', operatorAddress='0x9e56C62aa6185A8b7F30DAf5be0EA05718DB6997', amount=1, value=0, gasLimit=743176, gasPrice=121000000000, blockNumber=11003194, tokenType='erc721', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xd40859bfc1ce80da0e81b8f82b15db1222f6937d108daca7f259e3dd162c5170', registryAddress='0x50f5474724e0Ee42D9a4e711ccFB275809Fd6d4a', tokenId='91489', fromAddress='0xF91B20739309040c93eCD70ae8a7dAC4728d2Fbc', toAddress='0x9e56C62aa6185A8b7F30DAf5be0EA05718DB6997', operatorAddress='0x9e56C62aa6185A8b7F30DAf5be0EA05718DB6997', amount=1, value=0, gasLimit=743176, gasPrice=121000000000, blockNumber=11003194, tokenType='erc721', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xd40859bfc1ce80da0e81b8f82b15db1222f6937d108daca7f259e3dd162c5170', registryAddress='0x067a1Eb5E383eD24b66D72aAf80d8D7dB3d299A8', tokenId='55464657044963196816950587289035428064568320970692304673817341489687446964224', fromAddress='0xF91B20739309040c93eCD70ae8a7dAC4728d2Fbc', toAddress='0x9e56C62aa6185A8b7F30DAf5be0EA05718DB6997', operatorAddress='0x9E2d8A4847547e02624F34A309cC5BD4E56C2b31', amount=1, value=0, gasLimit=743176, gasPrice=121000000000, blockNumber=11003194, tokenType='erc1155single', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xd40859bfc1ce80da0e81b8f82b15db1222f6937d108daca7f259e3dd162c5170', registryAddress='0x067a1Eb5E383eD24b66D72aAf80d8D7dB3d299A8', tokenId='55464657044963196816950587289035428064568320970692304673817341489687446964225', fromAddress='0xF91B20739309040c93eCD70ae8a7dAC4728d2Fbc', toAddress='0x9e56C62aa6185A8b7F30DAf5be0EA05718DB6997', operatorAddress='0x9E2d8A4847547e02624F34A309cC5BD4E56C2b31', amount=1, value=0, gasLimit=743176, gasPrice=121000000000, blockNumber=11003194, tokenType='erc1155single', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xd40859bfc1ce80da0e81b8f82b15db1222f6937d108daca7f259e3dd162c5170', registryAddress='0x067a1Eb5E383eD24b66D72aAf80d8D7dB3d299A8', tokenId='55464657044963196816950587289035428064568320970692304673817341489687446964226', fromAddress='0xF91B20739309040c93eCD70ae8a7dAC4728d2Fbc', toAddress='0x9e56C62aa6185A8b7F30DAf5be0EA05718DB6997', operatorAddress='0x9E2d8A4847547e02624F34A309cC5BD4E56C2b31', amount=1, value=0, gasLimit=743176, gasPrice=121000000000, blockNumber=11003194, tokenType='erc1155single', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xd40859bfc1ce80da0e81b8f82b15db1222f6937d108daca7f259e3dd162c5170', registryAddress='0x067a1Eb5E383eD24b66D72aAf80d8D7dB3d299A8', tokenId='55464657044963196816950587289035428064568320970692304673817341489687446964227', fromAddress='0xF91B20739309040c93eCD70ae8a7dAC4728d2Fbc', toAddress='0x9e56C62aa6185A8b7F30DAf5be0EA05718DB6997', operatorAddress='0x9E2d8A4847547e02624F34A309cC5BD4E56C2b31', amount=1, value=0, gasLimit=743176, gasPrice=121000000000, blockNumber=11003194, tokenType='erc1155single', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xd40859bfc1ce80da0e81b8f82b15db1222f6937d108daca7f259e3dd162c5170', registryAddress='0x067a1Eb5E383eD24b66D72aAf80d8D7dB3d299A8', tokenId='55464657044963196816950587289035428064568320970692304673817341489687446964230', fromAddress='0xF91B20739309040c93eCD70ae8a7dAC4728d2Fbc', toAddress='0x9e56C62aa6185A8b7F30DAf5be0EA05718DB6997', operatorAddress='0x9E2d8A4847547e02624F34A309cC5BD4E56C2b31', amount=1, value=0, gasLimit=743176, gasPrice=121000000000, blockNumber=11003194, tokenType='erc1155single', isMultiAddress=True, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
        ]
        self.assertEqual(result, expected)

    async def test_ens_and_is_interstitial(self):
        # Account buys an NFT but there are interstitial transfers in the same transaction
        # https://etherscan.io/tx/0x6bb37dcb9a60ed49da56ccfb21dfcae886e81debd3ab94d73497d62744e758d2 started by 0x04c
        # Transfer of token 5309..: value=0 from 0x000 to 0x283 isInterstitial=true
        # Transfer of token 5309..: value=0.0014 from 0x283 to 0x04c
        result = await self._process_block_transaction(blockNumber=13898509, transactionHash='0x6bb37dcb9a60ed49da56ccfb21dfcae886e81debd3ab94d73497d62744e758d2')
        expected = [
            RetrievedTokenTransfer(transactionHash='0x6bb37dcb9a60ed49da56ccfb21dfcae886e81debd3ab94d73497d62744e758d2', registryAddress='0x57f1887a8BF19b14fC0dF6Fd9B2acc9Af147eA85', tokenId='53091478429947851570161017064535674537231673781900674689421707367586767084753', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x283Af0B28c62C092C9727F1Ee09c02CA627EB7F5', operatorAddress='0x04c1f61baF8DE8DA75DB52f09D9d92a1592f46eA', amount=1, value=0, gasLimit=295604, gasPrice=79444034756, blockNumber=13898509, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x6bb37dcb9a60ed49da56ccfb21dfcae886e81debd3ab94d73497d62744e758d2', registryAddress='0x57f1887a8BF19b14fC0dF6Fd9B2acc9Af147eA85', tokenId='53091478429947851570161017064535674537231673781900674689421707367586767084753', fromAddress='0x283Af0B28c62C092C9727F1Ee09c02CA627EB7F5', toAddress='0x04c1f61baF8DE8DA75DB52f09D9d92a1592f46eA', operatorAddress='0x04c1f61baF8DE8DA75DB52f09D9d92a1592f46eA', amount=1, value=1446765707746493, gasLimit=295604, gasPrice=79444034756, blockNumber=13898509, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
        ]
        self.assertEqual(result, expected)

    async def test_more_than_one_interstitial(self):
        # https://etherscan.io/tx/0xafd0535c4fe269b57cdcd4489eb11f05ff42dce04190b3e65f659ab9f05b71ee started by 0x92a
        # Transfer of token 5309..: value=0 from 0x393 to 0x000 isInterstitial=true
        # Transfer of token 5309..: value=0 from 0x000 to 0x283 isInterstitial=true
        # Transfer of token 5309..: value=0.005 from 0x283 to 0x04c
        result = await self._process_block_transaction(blockNumber=14471751, transactionHash='0xafd0535c4fe269b57cdcd4489eb11f05ff42dce04190b3e65f659ab9f05b71ee')
        expected = [
            RetrievedTokenTransfer(transactionHash='0xafd0535c4fe269b57cdcd4489eb11f05ff42dce04190b3e65f659ab9f05b71ee', registryAddress='0x57f1887a8BF19b14fC0dF6Fd9B2acc9Af147eA85', tokenId='78102327257348450385369200690909064778782768687076101371929764792747181439823', fromAddress='0x393E7176be67D8FaBA18B2c1C52eb827AA90a824', toAddress='0x0000000000000000000000000000000000000000', operatorAddress='0x92a2eAc2d5d442e489597cdBFEf75514fB97b4c0', amount=1, value=0, gasLimit=245377, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xafd0535c4fe269b57cdcd4489eb11f05ff42dce04190b3e65f659ab9f05b71ee', registryAddress='0x57f1887a8BF19b14fC0dF6Fd9B2acc9Af147eA85', tokenId='78102327257348450385369200690909064778782768687076101371929764792747181439823', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x283Af0B28c62C092C9727F1Ee09c02CA627EB7F5', operatorAddress='0x92a2eAc2d5d442e489597cdBFEf75514fB97b4c0', amount=1, value=0, gasLimit=245377, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xafd0535c4fe269b57cdcd4489eb11f05ff42dce04190b3e65f659ab9f05b71ee', registryAddress='0x57f1887a8BF19b14fC0dF6Fd9B2acc9Af147eA85', tokenId='78102327257348450385369200690909064778782768687076101371929764792747181439823', fromAddress='0x283Af0B28c62C092C9727F1Ee09c02CA627EB7F5', toAddress='0x92a2eAc2d5d442e489597cdBFEf75514fB97b4c0', operatorAddress='0x92a2eAc2d5d442e489597cdBFEf75514fB97b4c0', amount=1, value=5020756571078947, gasLimit=245377, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
        ]
        self.assertEqual(result, expected)

    async def test_multiple_tokens_have_interstitial(self):
        # Account buys multiple NFTs (of the same collection) from multiple accounts, but there are some interstitial transfers in the same transaction
        # https://etherscan.io/tx/0xd7721e7d21313f791ad279d806d9b506fe4acfc6bfbd0dec3436ce640ebc299d started by 0xdfd
        # Transfer of token 7723: value=0 from 0x505 to 0x83c isInterstitial=true
        # Transfer of token 7723: value=(5.73/3) from 0x83c to 0xdfd
        # Transfer of token 3624: value=0 from 0xfa8 to 0x83c isInterstitial=true
        # Transfer of token 3624: value=(5.73/3) from 0x83c to 0xdfd
        # Transfer of token 220: value=(5.73/3) from 0x9dc to 0xdfd
        result = await self._process_block_transaction(blockNumber=14806164, transactionHash='0xd7721e7d21313f791ad279d806d9b506fe4acfc6bfbd0dec3436ce640ebc299d')
        expected = [
            RetrievedTokenTransfer(transactionHash='0xd7721e7d21313f791ad279d806d9b506fe4acfc6bfbd0dec3436ce640ebc299d', registryAddress='0x160C404B2b49CBC3240055CEaEE026df1e8497A0', tokenId='220', fromAddress='0x9dC874b1194b144e7C90C9ABA0b6A510353FD130', toAddress='0xDFD521971212e789b5FF05EF8D9F324fE290e238', operatorAddress='0xDFD521971212e789b5FF05EF8D9F324fE290e238', amount=1, value=1910000000000000000, gasLimit=754081, gasPrice=21536358794, blockNumber=14806164, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xd7721e7d21313f791ad279d806d9b506fe4acfc6bfbd0dec3436ce640ebc299d', registryAddress='0x160C404B2b49CBC3240055CEaEE026df1e8497A0', tokenId='7723', fromAddress='0x5054A3283e57Cc1bd1109F596a0a5a31887D56FB', toAddress='0x83C8F28c26bF6aaca652Df1DbBE0e1b56F8baBa2', operatorAddress='0xDFD521971212e789b5FF05EF8D9F324fE290e238', amount=1, value=0, gasLimit=754081, gasPrice=21536358794, blockNumber=14806164, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xd7721e7d21313f791ad279d806d9b506fe4acfc6bfbd0dec3436ce640ebc299d', registryAddress='0x160C404B2b49CBC3240055CEaEE026df1e8497A0', tokenId='7723', fromAddress='0x83C8F28c26bF6aaca652Df1DbBE0e1b56F8baBa2', toAddress='0xDFD521971212e789b5FF05EF8D9F324fE290e238', operatorAddress='0xDFD521971212e789b5FF05EF8D9F324fE290e238', amount=1, value=1910000000000000000, gasLimit=754081, gasPrice=21536358794, blockNumber=14806164, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xd7721e7d21313f791ad279d806d9b506fe4acfc6bfbd0dec3436ce640ebc299d', registryAddress='0x160C404B2b49CBC3240055CEaEE026df1e8497A0', tokenId='3624', fromAddress='0xfa880465C4C1bd5bDf77C06F71bC0d5F77D383AD', toAddress='0x83C8F28c26bF6aaca652Df1DbBE0e1b56F8baBa2', operatorAddress='0xDFD521971212e789b5FF05EF8D9F324fE290e238', amount=1, value=0, gasLimit=754081, gasPrice=21536358794, blockNumber=14806164, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xd7721e7d21313f791ad279d806d9b506fe4acfc6bfbd0dec3436ce640ebc299d', registryAddress='0x160C404B2b49CBC3240055CEaEE026df1e8497A0', tokenId='3624', fromAddress='0x83C8F28c26bF6aaca652Df1DbBE0e1b56F8baBa2', toAddress='0xDFD521971212e789b5FF05EF8D9F324fE290e238', operatorAddress='0xDFD521971212e789b5FF05EF8D9F324fE290e238', amount=1, value=1910000000000000000, gasLimit=754081, gasPrice=21536358794, blockNumber=14806164, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
        ]
        self.assertEqual(result, expected)

    async def test_is_batch(self):
        result = await self._process_block_transaction(blockNumber=14471751, transactionHash='0x7e2d9da491c020a15ed394899a1344560649ce9b07b7a195c425d7b218551954')
        expected =[
            RetrievedTokenTransfer(transactionHash='0x7e2d9da491c020a15ed394899a1344560649ce9b07b7a195c425d7b218551954', registryAddress='0xAcfA101ECE167F1894150e090d9471aeE2dD3041', tokenId='3729', fromAddress='0xB8b6aF171335Ce2E327Afd2ebEf1a2c46cd67B01', toAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', operatorAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', amount=1, value=137880000000000000, gasLimit=963497, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x7e2d9da491c020a15ed394899a1344560649ce9b07b7a195c425d7b218551954', registryAddress='0xAcfA101ECE167F1894150e090d9471aeE2dD3041', tokenId='3698', fromAddress='0x9c8BF4D407cff32eC725eb7D43E106163d182269', toAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', operatorAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', amount=1, value=137880000000000000, gasLimit=963497, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x7e2d9da491c020a15ed394899a1344560649ce9b07b7a195c425d7b218551954', registryAddress='0xAcfA101ECE167F1894150e090d9471aeE2dD3041', tokenId='3534', fromAddress='0x30d82b3cB565Da738383356fd17E9306692Bd5b2', toAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', operatorAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', amount=1, value=137880000000000000, gasLimit=963497, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x7e2d9da491c020a15ed394899a1344560649ce9b07b7a195c425d7b218551954', registryAddress='0xAcfA101ECE167F1894150e090d9471aeE2dD3041', tokenId='2539', fromAddress='0x1a63efB8E8b52e63F700038e17909Cf76AEf5415', toAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', operatorAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', amount=1, value=137880000000000000, gasLimit=963497, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x7e2d9da491c020a15ed394899a1344560649ce9b07b7a195c425d7b218551954', registryAddress='0xAcfA101ECE167F1894150e090d9471aeE2dD3041', tokenId='130', fromAddress='0x40Fa37128A7d54DAB2392ACBC4f43827bc67bBE4', toAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', operatorAddress='0x27a45e97c01f30D3E3F7f76734BB8d8b9AF03Eb0', amount=1, value=137880000000000000, gasLimit=963497, gasPrice=24985808182, blockNumber=14471751, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
        ]
        self.assertEqual(result, expected)

    async def test_buying_with_erc_20(self):
        # Account buying an NFT with ERC-20 not eth
        # https://etherscan.io/tx/0xdfc7fa60b02bb76f021e1ddd7ce61ba654f0fa5df6214fcc412935fd95fa8705 started by 0x400
        # Transfer of 219281: value=0.015 from 0x000 to 0x400
        result = await self._process_block_transaction(blockNumber=14550945, transactionHash='0xdfc7fa60b02bb76f021e1ddd7ce61ba654f0fa5df6214fcc412935fd95fa8705')
        expected = [
            RetrievedTokenTransfer(transactionHash='0xdfc7fa60b02bb76f021e1ddd7ce61ba654f0fa5df6214fcc412935fd95fa8705', registryAddress='0xC36442b4a4522E871399CD717aBDD847Ab11FE88', tokenId='219281', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x400815b954C964C3BC356E5541301D957D417EC9', operatorAddress='0x400815b954C964C3BC356E5541301D957D417EC9', amount=1, value=15677481882371820, gasLimit=495462, gasPrice=32756055350, blockNumber=14550945, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
        ]
        self.assertEqual(result, expected)

    async def test_selling_with_erc_20(self):
        # Account accepts an offer for purchase in ERC-20 not eth
        # https://etherscan.io/tx/0x09890dfbd47c251f16088ce6f995228d5f864f43ce620b70edd6fd852be9d4e1 started by 0x283
        # Transfer of 9571: value=0 (goal:1.15) from 0x283 to 0x28a
        result = await self._process_block_transaction(blockNumber=14851881, transactionHash='0x09890dfbd47c251f16088ce6f995228d5f864f43ce620b70edd6fd852be9d4e1')
        expected = [
            RetrievedTokenTransfer(transactionHash='0x09890dfbd47c251f16088ce6f995228d5f864f43ce620b70edd6fd852be9d4e1', registryAddress='0xfE8C6d19365453D26af321D0e8c910428c23873F', tokenId='9571', fromAddress='0x283929Fa5fcFaf27D9898FD867A78Fb5a8B44b5F', toAddress='0x28ad7d7838E693d05B64d516171ea0D3Bd67b70b', operatorAddress='0x283929Fa5fcFaf27D9898FD867A78Fb5a8B44b5F', amount=1, value=0, gasLimit=293512, gasPrice=74122712424, blockNumber=14851881, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True),
        ]
        self.assertEqual(result, expected)

    async def test_minting_multiple_tokens_from_same_collection(self):
        # Account buys NFTs for another account
        # https://etherscan.io/tx/0x1a466fa7f3815776d272bdb70a2f0a306d8aa1d10953f98d9531e81c7bb7d36b started by 0xbd9
        # 7 Transfers: value=(0.4816/7) from 0x000 0x126
        result = await self._process_block_transaction(blockNumber=14853186, transactionHash='0x1a466fa7f3815776d272bdb70a2f0a306d8aa1d10953f98d9531e81c7bb7d36b')
        expected = [
            RetrievedTokenTransfer(transactionHash='0x1a466fa7f3815776d272bdb70a2f0a306d8aa1d10953f98d9531e81c7bb7d36b', registryAddress='0x5b42A31DcB0718a1EEf25Ed2600475A97bF1fE65', tokenId='201', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x126449dE757B50714C04D01434492B3c7090f8cb', operatorAddress='0xbd9FF6eb3E115E8EB19aaAdfB71807E76274990B', amount=1, value=68800000000000000, gasLimit=1043788, gasPrice=24437785018, blockNumber=14853186, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x1a466fa7f3815776d272bdb70a2f0a306d8aa1d10953f98d9531e81c7bb7d36b', registryAddress='0x5b42A31DcB0718a1EEf25Ed2600475A97bF1fE65', tokenId='202', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x126449dE757B50714C04D01434492B3c7090f8cb', operatorAddress='0xbd9FF6eb3E115E8EB19aaAdfB71807E76274990B', amount=1, value=68800000000000000, gasLimit=1043788, gasPrice=24437785018, blockNumber=14853186, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x1a466fa7f3815776d272bdb70a2f0a306d8aa1d10953f98d9531e81c7bb7d36b', registryAddress='0x5b42A31DcB0718a1EEf25Ed2600475A97bF1fE65', tokenId='203', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x126449dE757B50714C04D01434492B3c7090f8cb', operatorAddress='0xbd9FF6eb3E115E8EB19aaAdfB71807E76274990B', amount=1, value=68800000000000000, gasLimit=1043788, gasPrice=24437785018, blockNumber=14853186, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x1a466fa7f3815776d272bdb70a2f0a306d8aa1d10953f98d9531e81c7bb7d36b', registryAddress='0x5b42A31DcB0718a1EEf25Ed2600475A97bF1fE65', tokenId='204', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x126449dE757B50714C04D01434492B3c7090f8cb', operatorAddress='0xbd9FF6eb3E115E8EB19aaAdfB71807E76274990B', amount=1, value=68800000000000000, gasLimit=1043788, gasPrice=24437785018, blockNumber=14853186, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x1a466fa7f3815776d272bdb70a2f0a306d8aa1d10953f98d9531e81c7bb7d36b', registryAddress='0x5b42A31DcB0718a1EEf25Ed2600475A97bF1fE65', tokenId='205', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x126449dE757B50714C04D01434492B3c7090f8cb', operatorAddress='0xbd9FF6eb3E115E8EB19aaAdfB71807E76274990B', amount=1, value=68800000000000000, gasLimit=1043788, gasPrice=24437785018, blockNumber=14853186, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x1a466fa7f3815776d272bdb70a2f0a306d8aa1d10953f98d9531e81c7bb7d36b', registryAddress='0x5b42A31DcB0718a1EEf25Ed2600475A97bF1fE65', tokenId='206', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x126449dE757B50714C04D01434492B3c7090f8cb', operatorAddress='0xbd9FF6eb3E115E8EB19aaAdfB71807E76274990B', amount=1, value=68800000000000000, gasLimit=1043788, gasPrice=24437785018, blockNumber=14853186, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x1a466fa7f3815776d272bdb70a2f0a306d8aa1d10953f98d9531e81c7bb7d36b', registryAddress='0x5b42A31DcB0718a1EEf25Ed2600475A97bF1fE65', tokenId='207', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x126449dE757B50714C04D01434492B3c7090f8cb', operatorAddress='0xbd9FF6eb3E115E8EB19aaAdfB71807E76274990B', amount=1, value=68800000000000000, gasLimit=1043788, gasPrice=24437785018, blockNumber=14853186, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
        ]
        self.assertEqual(result, expected)

    async def test_swapping_of_tokens(self):
        # Account buys NFT from another account with ERC-721 token plus eth
        # https://etherscan.io/tx/0x466e880275ee3f815d0c0bd787009632a437eefe1e7e7dab753d21ea16c0bd8b started by 0xaf6
        # Transfer of token 7963 value=(0) from 0x13d to 0xaf6 isSwap=true
        # Transfer of token 7139 value=7eth from 0xaf6 to 0x023 isSwap=true
        result = await self._process_block_transaction(blockNumber=14806164, transactionHash='0x466e880275ee3f815d0c0bd787009632a437eefe1e7e7dab753d21ea16c0bd8b')
        expected = [
            RetrievedTokenTransfer(transactionHash='0x466e880275ee3f815d0c0bd787009632a437eefe1e7e7dab753d21ea16c0bd8b', registryAddress='0xBC4CA0EdA7647A8aB7C2061c2E118A18a936f13D', tokenId='7963', fromAddress='0x13d8faF4A690f5AE52E2D2C52938d1167057B9af', toAddress='0xAf6209795446f33492133dF966042BC2B568d866', operatorAddress='0xAf6209795446f33492133dF966042BC2B568d866', amount=1, value=0, gasLimit=515008, gasPrice=21442773112, blockNumber=14806164, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=True, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x466e880275ee3f815d0c0bd787009632a437eefe1e7e7dab753d21ea16c0bd8b', registryAddress='0xBC4CA0EdA7647A8aB7C2061c2E118A18a936f13D', tokenId='7139', fromAddress='0xAf6209795446f33492133dF966042BC2B568d866', toAddress='0x0232d1083E970F0c78f56202b9A666B526FA379F', operatorAddress='0xAf6209795446f33492133dF966042BC2B568d866', amount=1, value=0, gasLimit=515008, gasPrice=21442773112, blockNumber=14806164, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=True, isBatch=True, isOutbound=True),
        ]
        self.assertEqual(result, expected)

    async def test_is_batch_multiple_interstitial(self):
        result = await self._process_block_transaction(blockNumber=14748832, transactionHash='0xf53d103bec79b91de7e29a71a44fc32fa8407edfe01623f8c3ed3f9f9ebc85b6')
        expected = [
            RetrievedTokenTransfer(transactionHash='0xf53d103bec79b91de7e29a71a44fc32fa8407edfe01623f8c3ed3f9f9ebc85b6', registryAddress='0xb4d06d46A8285F4EC79Fd294F78a881799d8cEd9', tokenId='8947', fromAddress='0x9762a4773ea912f699365261B55c3075D8aD55AC', toAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', operatorAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', amount=1, value=1163750000000000000, gasLimit=2271239, gasPrice=34755900972, blockNumber=14748832, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xf53d103bec79b91de7e29a71a44fc32fa8407edfe01623f8c3ed3f9f9ebc85b6', registryAddress='0xb4d06d46A8285F4EC79Fd294F78a881799d8cEd9', tokenId='1907', fromAddress='0x40711B63dB79a5E8579bD53f84c5C558E856F806', toAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', operatorAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', amount=1, value=1163750000000000000, gasLimit=2271239, gasPrice=34755900972, blockNumber=14748832, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xf53d103bec79b91de7e29a71a44fc32fa8407edfe01623f8c3ed3f9f9ebc85b6', registryAddress='0xb4d06d46A8285F4EC79Fd294F78a881799d8cEd9', tokenId='2408', fromAddress='0x89BFe3Acc91FbE3C3EA5d0aAa782Bb59a34544d1', toAddress='0x83C8F28c26bF6aaca652Df1DbBE0e1b56F8baBa2', operatorAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', amount=1, value=0, gasLimit=2271239, gasPrice=34755900972, blockNumber=14748832, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xf53d103bec79b91de7e29a71a44fc32fa8407edfe01623f8c3ed3f9f9ebc85b6', registryAddress='0xb4d06d46A8285F4EC79Fd294F78a881799d8cEd9', tokenId='2408', fromAddress='0x83C8F28c26bF6aaca652Df1DbBE0e1b56F8baBa2', toAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', operatorAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', amount=1, value=1163750000000000000, gasLimit=2271239, gasPrice=34755900972, blockNumber=14748832, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xf53d103bec79b91de7e29a71a44fc32fa8407edfe01623f8c3ed3f9f9ebc85b6', registryAddress='0xb4d06d46A8285F4EC79Fd294F78a881799d8cEd9', tokenId='7513', fromAddress='0x4682F2465436E97F25Acf00484Ae40Eb60eb9A67', toAddress='0x83C8F28c26bF6aaca652Df1DbBE0e1b56F8baBa2', operatorAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', amount=1, value=0, gasLimit=2271239, gasPrice=34755900972, blockNumber=14748832, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xf53d103bec79b91de7e29a71a44fc32fa8407edfe01623f8c3ed3f9f9ebc85b6', registryAddress='0xb4d06d46A8285F4EC79Fd294F78a881799d8cEd9', tokenId='7513', fromAddress='0x83C8F28c26bF6aaca652Df1DbBE0e1b56F8baBa2', toAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', operatorAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', amount=1, value=1163750000000000000, gasLimit=2271239, gasPrice=34755900972, blockNumber=14748832, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xf53d103bec79b91de7e29a71a44fc32fa8407edfe01623f8c3ed3f9f9ebc85b6', registryAddress='0xb4d06d46A8285F4EC79Fd294F78a881799d8cEd9', tokenId='1230', fromAddress='0x24e013156619A4A28AbAc56Bda14C516667bF975', toAddress='0x83C8F28c26bF6aaca652Df1DbBE0e1b56F8baBa2', operatorAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', amount=1, value=0, gasLimit=2271239, gasPrice=34755900972, blockNumber=14748832, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xf53d103bec79b91de7e29a71a44fc32fa8407edfe01623f8c3ed3f9f9ebc85b6', registryAddress='0xb4d06d46A8285F4EC79Fd294F78a881799d8cEd9', tokenId='1230', fromAddress='0x83C8F28c26bF6aaca652Df1DbBE0e1b56F8baBa2', toAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', operatorAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', amount=1, value=1163750000000000000, gasLimit=2271239, gasPrice=34755900972, blockNumber=14748832, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xf53d103bec79b91de7e29a71a44fc32fa8407edfe01623f8c3ed3f9f9ebc85b6', registryAddress='0xb4d06d46A8285F4EC79Fd294F78a881799d8cEd9', tokenId='1327', fromAddress='0x3E8a6726f43E6A7470Ff2c99dB5B73A2F81AFB3D', toAddress='0x83C8F28c26bF6aaca652Df1DbBE0e1b56F8baBa2', operatorAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', amount=1, value=0, gasLimit=2271239, gasPrice=34755900972, blockNumber=14748832, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xf53d103bec79b91de7e29a71a44fc32fa8407edfe01623f8c3ed3f9f9ebc85b6', registryAddress='0xb4d06d46A8285F4EC79Fd294F78a881799d8cEd9', tokenId='1327', fromAddress='0x83C8F28c26bF6aaca652Df1DbBE0e1b56F8baBa2', toAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', operatorAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', amount=1, value=1163750000000000000, gasLimit=2271239, gasPrice=34755900972, blockNumber=14748832, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xf53d103bec79b91de7e29a71a44fc32fa8407edfe01623f8c3ed3f9f9ebc85b6', registryAddress='0xb4d06d46A8285F4EC79Fd294F78a881799d8cEd9', tokenId='876', fromAddress='0x963966C7e65678B9f5440507BAcCfB5Ced8DeC65', toAddress='0x83C8F28c26bF6aaca652Df1DbBE0e1b56F8baBa2', operatorAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', amount=1, value=0, gasLimit=2271239, gasPrice=34755900972, blockNumber=14748832, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xf53d103bec79b91de7e29a71a44fc32fa8407edfe01623f8c3ed3f9f9ebc85b6', registryAddress='0xb4d06d46A8285F4EC79Fd294F78a881799d8cEd9', tokenId='876', fromAddress='0x83C8F28c26bF6aaca652Df1DbBE0e1b56F8baBa2', toAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', operatorAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', amount=1, value=1163750000000000000, gasLimit=2271239, gasPrice=34755900972, blockNumber=14748832, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xf53d103bec79b91de7e29a71a44fc32fa8407edfe01623f8c3ed3f9f9ebc85b6', registryAddress='0xb4d06d46A8285F4EC79Fd294F78a881799d8cEd9', tokenId='3726', fromAddress='0x0E5c9240779feB1C948D048E700cb96057b146A1', toAddress='0x83C8F28c26bF6aaca652Df1DbBE0e1b56F8baBa2', operatorAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', amount=1, value=0, gasLimit=2271239, gasPrice=34755900972, blockNumber=14748832, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0xf53d103bec79b91de7e29a71a44fc32fa8407edfe01623f8c3ed3f9f9ebc85b6', registryAddress='0xb4d06d46A8285F4EC79Fd294F78a881799d8cEd9', tokenId='3726', fromAddress='0x83C8F28c26bF6aaca652Df1DbBE0e1b56F8baBa2', toAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', operatorAddress='0x08046e2349017615d53D3977c307d39AB4eEB3CF', amount=1, value=1163750000000000000, gasLimit=2271239, gasPrice=34755900972, blockNumber=14748832, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=True, isOutbound=False),
        ]
        self.assertEqual(result, expected)

    async def test_ens_is_interstitial(self):
        result = await self._process_block_transaction(blockNumber=14747306, transactionHash='0x00176653394a0ddfea697e6fdbd67630e8196e4de04afc46a3927480d7dc2e93')
        expected = [
            RetrievedTokenTransfer(transactionHash='0x00176653394a0ddfea697e6fdbd67630e8196e4de04afc46a3927480d7dc2e93', registryAddress='0x57f1887a8BF19b14fC0dF6Fd9B2acc9Af147eA85', tokenId='49292164327206987068568468070661731820284689921166579102841753123805598472689', fromAddress='0x0000000000000000000000000000000000000000', toAddress='0x283Af0B28c62C092C9727F1Ee09c02CA627EB7F5', operatorAddress='0xba26232213ba33eE1fc73fc9f2848c3ec55f4F8f', amount=1, value=0, gasLimit=287785, gasPrice=39321890650, blockNumber=14747306, tokenType='erc721', isMultiAddress=False, isInterstitial=True, isSwap=False, isBatch=False, isOutbound=False),
            RetrievedTokenTransfer(transactionHash='0x00176653394a0ddfea697e6fdbd67630e8196e4de04afc46a3927480d7dc2e93', registryAddress='0x57f1887a8BF19b14fC0dF6Fd9B2acc9Af147eA85', tokenId='49292164327206987068568468070661731820284689921166579102841753123805598472689', fromAddress='0x283Af0B28c62C092C9727F1Ee09c02CA627EB7F5', toAddress='0xba26232213ba33eE1fc73fc9f2848c3ec55f4F8f', operatorAddress='0xba26232213ba33eE1fc73fc9f2848c3ec55f4F8f', amount=1, value=2290906896335853, gasLimit=287785, gasPrice=39321890650, blockNumber=14747306, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False),
        ]
        self.assertEqual(result, expected)

    async def test_is_outbound(self):
        result = await self._process_block_transaction(blockNumber=15014054, transactionHash='0x6332d565f96a1ae47ae403df47acc0d28fe11c409fb2e3cc4d1a96a1c5987ed8')
        expected = [
            RetrievedTokenTransfer(transactionHash='0x6332d565f96a1ae47ae403df47acc0d28fe11c409fb2e3cc4d1a96a1c5987ed8', registryAddress='0x49cF6f5d44E70224e2E23fDcdd2C053F30aDA28B', tokenId='17028', fromAddress='0xB0c3666a6980D6cfBB97890564934e0d818A9e4A', toAddress='0xe7967e0ec15CB48939Fcf0BC5764c2a634349eCB', operatorAddress='0xB0c3666a6980D6cfBB97890564934e0d818A9e4A', amount=1, value=0, gasLimit=356881, gasPrice=72692865001, blockNumber=15014054, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=True)
        ]
        self.assertEqual(result, expected)
    
    async def test_contract_creation(self):
        result = await self._process_block_transaction(blockNumber=4313447, transactionHash='0x9aea97f9124ce28745206a721b955ca915d09fe9cb97210290b73465802ca44e')
        expected = [RetrievedTokenTransfer(transactionHash='0x9aea97f9124ce28745206a721b955ca915d09fe9cb97210290b73465802ca44e', registryAddress='0xe46912A20A7E84da7f29Cdd6883AA71a7864F23f', tokenId='600000000000000000000000000', fromAddress='0xe46912A20A7E84da7f29Cdd6883AA71a7864F23f', toAddress='0x514bc174df04a4b04ae2Be81ee8c788c3796B06B', operatorAddress='0xc98588F01cCc612FE010ef7bF29d6748d4621b72', contractAddress=None, amount=1, value=0, gasLimit=3066382, gasPrice=42000000000, blockNumber=4313447, tokenType='erc721', isMultiAddress=False, isInterstitial=False, isSwap=False, isBatch=False, isOutbound=False)]
        self.assertEqual(result, expected)

if __name__ == '__main__':
   unittest.main()
